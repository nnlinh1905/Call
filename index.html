<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CallCenter</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./htmlCss.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/src/popup/notiflix-3.2.5.min.css" />

    <script src="/src/popup/notiflix-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-aio-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-notify-aio-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-report-aio-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-confirm-aio-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-loading-aio-3.2.5.min.js"></script>

    <script src="/src/popup/notiflix-block-aio-3.2.5.min.js"></script>

    <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
    <script src="./socket.js"></script>
    <audio id="ringtone" src="/src/sipCall/sounds/incoming.mp3" loop></audio>
    <audio
      id="ringbacktone"
      src="/src/sipCall/sounds/outgoing.mp3"
      loop
    ></audio>
    <audio id="dtmfTone" src="/src/sipCall/sounds/dtmf.mp3"></audio>
    <audio id="transferTone" src="/src/sipCall/sounds/transfer.mp3"></audio>
    <script src="/src/sipCall/scripts/SIP.js/sip.js"></script>
    <script src="/src/sipCall/scripts/SIP.js/sip.min.js"></script>
    <audio id="audioRemote"></audio>
  </head>
  <body>
    <div class="phone-pad">
      <div
        class="jss371"
        style="right: 16px; z-index: 1111; display: none"
        id="modal-call"
      >
        <button
          class="btn-pad-number jss386 medium ss-1bvttbo"
          tabindex="0"
          type="button"
          onclick="btnOffModalCall()"
          style="
            min-width: unset;
            width: fit-content; /* box-shadow: none; */
            line-height: normal;
            border-radius: 6px;
            text-transform: none;
            letter-spacing: normal;
            font-size: 15px;
            right: calc(100% + 16px);
            display: flex;
            border: none;
          "
        >
          <div class="close-modal-call">
            <input type="hidden" id="idCallCustomer" name="" />
            <div
              class="css-17xyljb css-1lrnpvo"
              width="20"
              height="20"
              color="primary"
            >
              <div>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 172 172"
                  class="injected-svg"
                  data-src="/_next/static/chunks/media/images/ic_cancel_filled.6e0079ff9495c6378db2.svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  role="img"
                  style="height: 100%"
                >
                  <g
                    fill="none"
                    stroke-miterlimit="10"
                    font-family="none"
                    font-weight="none"
                    font-size="none"
                    text-anchor="none"
                    style="mix-blend-mode: normal"
                  >
                    <path d="M0 172V0h172v172z"></path>
                    <path
                      d="M86 14.333c-39.581 0-71.667 32.085-71.667 71.667 0 39.581 32.086 71.667 71.667 71.667S157.667 125.582 157.667 86c0-39.581-32.085-71.667-71.667-71.667zm27.094 91.157c2.1 2.1 2.1 5.5 0 7.6a5.347 5.347 0 0 1-3.802 1.577 5.358 5.358 0 0 1-3.802-1.573L86 93.6l-19.49 19.49a5.347 5.347 0 0 1-3.802 1.577 5.372 5.372 0 0 1-3.802-9.173L78.4 86 58.91 66.51c-2.1-2.1-2.1-5.5 0-7.6 2.1-2.1 5.5-2.1 7.6 0L86 78.4l19.49-19.49c2.1-2.1 5.5-2.1 7.6 0 2.1 2.1 2.1 5.5 0 7.6L93.6 86z"
                      fill="#1e3150"
                    ></path>
                  </g>
                </svg>
              </div>
            </div>
          </div>
          <span class="MuiTouchRipple-root css-w0pj6f"></span>
        </button>
        <div class="jss372">
          <div class="jss534 phone-active">
            <div class="jss556 name">
              <span class="phone-incall" data-key="" data-label=""></span>
            </div>
            <img
              alt=""
              class="css-el3kt1"
              width="auto"
              height="20"
              src="/src/assets/icon/phone_black.png"
            />
          </div>
          <div class="jss374">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 172 172"
              class="injected-svg"
              data-src="/_next/static/chunks/media/images/ic_sort_right_filled.188a7a40c44414fcd86a.svg"
              xmlns:xlink="http://www.w3.org/1999/xlink"
              role="img"
              style="height: 100%"
            >
              <g
                fill="none"
                stroke-miterlimit="10"
                font-family="none"
                font-weight="none"
                font-size="none"
                text-anchor="none"
                style="mix-blend-mode: normal"
              >
                <path d="M0 172V0h172v172z"></path>
                <path
                  d="M49.575 29.222a5.376 5.376 0 0 0-2.992 4.82v103.916a5.376 5.376 0 0 0 5.375 5.375 5.354 5.354 0 0 0 3.261-1.103l68.084-51.959a5.37 5.37 0 0 0 0-8.542L55.219 29.77a5.389 5.389 0 0 0-5.644-.548z"
                  fill="#1e3150"
                ></path>
              </g>
            </svg>
          </div>
        </div>
        <div class="jss375 scrollable">
          <div
            class="float-interact position-absolute w-100 z-index-999 bg-white pb-2"
          >
            <div class="jss387 mt-2">
              <div>
                <div class="d-flex flex-row">
                  <div class="my-auto">
                    <h5 class="fw-bolder mb-0 date-now"></h5>
                    <p class="card-text font-small-3 mb-0">
                      <i class="fa-regular fa-clock"></i>
                      <span class="time-now"></span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <div
                class="jss388 opacity modal-search-phone"
                aria-label="Mục đích cuộc gọi"
                style="background-color: #2d50b2"
              >
                <div class="css-17xyljb" width="20" height="20">
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <span>Cuộc gọi nhanh</span>
                <div class="jss389">
                  <div class="css-iamfhq" width="12px" height="12px">
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_sort_right_filled.188a7a40c44414fcd86a.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          y-called
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M49.575 29.222a5.376 5.376 0 0 0-2.992 4.82v103.916a5.376 5.376 0 0 0 5.375 5.375 5.354 5.354 0 0 0 3.261-1.103l68.084-51.959a5.37 5.37 0 0 0 0-8.542L55.219 29.77a5.389 5.389 0 0 0-5.644-.548z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="jss389">
            <div class="history-called active" style="width: 100%">
              <span class="jss390 w-100" style="margin-bottom: 8px">
                Cuộc gọi gần nhất
              </span>
              <div class="list-history-call w-100"></div>
            </div>

            <div class="recommend-call w-100">
              <span class="jss390 w-100" style="margin-bottom: 8px">
                Danh sách gợi ý
              </span>
              <div class="list-recommed-call w-100"></div>
            </div>
          </div>
        </div>
        <div class="jss382">
          <div class="jss458">
            <input
              placeholder="Nhập số điện thoại"
              value=""
              id="number-phone"
            />
            <button
              class="clear-number-phone btn-pad-number hbg-primary circle rounded btn-pad-number hbg-primary circle rounded css-1bvttbo"
              tabindex="0"
              type="button"
              style="
                min-width: 32px;
                width: 32px;
                box-shadow: none;
                line-height: normal;
                border-radius: 50%;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                padding: 0px;
                height: 32px;
                margin-left: 12px;
                display: none;
              "
            >
              <div
                draggable="false"
                class="css-17xyljb css-1lrnpvo"
                width="20"
                height="20"
                color="primary"
              >
                <div>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 172 172"
                    class="injected-svg"
                    data-src="/_next/static/chunks/media/images/ic_cancel_filled.6e0079ff9495c6378db2.svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    role="img"
                    style="height: 100%"
                  >
                    <g
                      fill="none"
                      stroke-miterlimit="10"
                      font-family="none"
                      font-weight="none"
                      font-size="none"
                      text-anchor="none"
                      style="mix-blend-mode: normal"
                    >
                      <path d="M0 172V0h172v172z"></path>
                      <path
                        d="M86 14.333c-39.581 0-71.667 32.085-71.667 71.667 0 39.581 32.086 71.667 71.667 71.667S157.667 125.582 157.667 86c0-39.581-32.085-71.667-71.667-71.667zm27.094 91.157c2.1 2.1 2.1 5.5 0 7.6a5.347 5.347 0 0 1-3.802 1.577 5.358 5.358 0 0 1-3.802-1.573L86 93.6l-19.49 19.49a5.347 5.347 0 0 1-3.802 1.577 5.372 5.372 0 0 1-3.802-9.173L78.4 86 58.91 66.51c-2.1-2.1-2.1-5.5 0-7.6 2.1-2.1 5.5-2.1 7.6 0L86 78.4l19.49-19.49c2.1-2.1 5.5-2.1 7.6 0 2.1 2.1 2.1 5.5 0 7.6L93.6 86z"
                        fill="#1e3150"
                      ></path>
                    </g>
                  </svg>
                </div>
              </div>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
          </div>
          <div class="jss384">
            <button
              class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh csdPhoneClient"
              tabindex="0"
              type="button"
              onclick="csdPhoneClient()"
              style="
                min-width: unset;
                background: #2d50b2 !important;
                box-shadow: none;
                line-height: normal;
                border-radius: 12px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                padding: 0px;
              "
            >
              <div
                draggable="false"
                class="css-17xyljb css-1lrnpvo"
                width="20"
                height="20"
                color="primary"
              >
                <div>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 172 172"
                    class="injected-svg"
                    data-src="/_next/static/chunks/media/images/ic_phone_filled.251aab66be05671ffa54.svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    role="img"
                    style="height: 100%"
                  >
                    <g
                      fill="none"
                      stroke-miterlimit="10"
                      font-family="none"
                      font-weight="none"
                      font-size="none"
                      text-anchor="none"
                      style="mix-blend-mode: normal"
                    >
                      <path d="M0 172V0h172v172z"></path>
                      <path
                        d="m82.116 23.74 6.16 14.53c2.683 6.332 1.196 13.778-3.684 18.408L73.082 67.6c-1.297 1.232-1.97 3.02-1.68 4.783 1.11 6.74 3.572 13.388 7.385 19.945 3.805 6.543 8.438 12.112 13.903 16.702 1.448 1.215 3.458 1.53 5.25.932l13.426-4.48c6.182-2.06 12.911.309 16.702 5.877l8.833 12.975c4.408 6.476 3.616 15.405-1.852 20.895l-5.863 5.884c-5.833 5.855-14.165 7.98-21.872 5.575-18.197-5.676-34.924-22.524-50.189-50.55-15.286-28.064-20.679-51.88-16.182-71.437 1.892-8.23 7.75-14.785 15.401-17.229l7.715-2.465c7.239-2.304 14.96 1.43 18.057 8.733z"
                        fill="#1e3150"
                      ></path>
                    </g>
                  </svg>
                </div>
              </div>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <div class="jss385">
              <button
                class="btn-pad-number on-off-pad medium hbg-primary rounded css-1bvttbo"
                tabindex="0"
                type="button"
                onclick="btnOnOffModalPadNumber()"
                style="
                  min-width: unset;
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_ten_keys.fe2c93690deba9a3a2c3.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M69.791 17.84a5.375 5.375 0 0 0-.784.077H48.375c-8.842 0-16.125 7.283-16.125 16.125V54.66a5.375 5.375 0 0 0 0 1.743V86.91a5.375 5.375 0 0 0 0 1.743v20.639c0 8.842 7.283 16.125 16.125 16.125H64.5v16.125c0 8.842 7.283 16.125 16.125 16.125h10.75c8.842 0 16.125-7.283 16.125-16.125v-16.125h16.125c8.842 0 16.125-7.283 16.125-16.125V88.674a5.375 5.375 0 0 0 0-1.743V56.424a5.375 5.375 0 0 0 0-1.743V34.04c0-8.841-7.283-16.124-16.125-16.124h-20.618a5.375 5.375 0 0 0-1.743 0H70.757a5.376 5.376 0 0 0-.966-.077zM48.375 28.667H64.5v21.5H43V34.042c0-3.034 2.342-5.375 5.375-5.375zm26.875 0h21.5v21.5h-21.5zm32.25 0h16.125c3.033 0 5.375 2.341 5.375 5.375v16.125h-21.5zM43 60.917h21.5v21.5H43zm32.25 0h21.5v21.5h-21.5zm32.25 0H129v21.5h-21.5zM43 93.167h21.5v21.5H48.375c-3.033 0-5.375-2.342-5.375-5.375zm32.25 0h21.5v21.5h-21.5zm32.25 0H129v16.125c0 3.033-2.342 5.375-5.375 5.375H107.5zm-32.25 32.25h21.5v16.125c0 3.033-2.342 5.375-5.375 5.375h-10.75c-3.033 0-5.375-2.342-5.375-5.375z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <span class="MuiTouchRipple-root css-w0pj6f"></span>
              </button>

              <button
                class="btn-pad-number medium hbg-primary rounded btn-change-status-extension css-1bvttbo"
                tabindex="0"
                type="button"
                onclick="btnChangeStatusExtension()"
                data-bs-toggle="tooltip"
                data-bs-placement="top"
                title="Tooltip on top"
                style="
                  min-width: unset;
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <span class="MuiTouchRipple-root css-w0pj6f"></span>
              </button>
              <button
                class="btn-pad-number medium hbg-primary rounded css-1bvttbo call-settings"
                tabindex="0"
                type="button"
                onclick="settings()"
                aria-label="Tự động phát file LazyCall: Tắt"
                style="
                  min-width: unset;
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_settings.5b3c855b55461fad50a1.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M86 14.333c-5.65 0-11.099.715-16.3 1.925a5.376 5.376 0 0 0-4.122 4.654l-1.141 10.4a10.744 10.744 0 0 1-15.012 8.664h-.007l-9.553-4.206a5.376 5.376 0 0 0-6.09 1.246C26.35 44.934 20.65 54.521 17.414 65.221a5.376 5.376 0 0 0 1.966 5.893l8.476 6.215A10.746 10.746 0 0 1 32.25 86c0 3.432-1.628 6.641-4.395 8.671l-8.476 6.208a5.376 5.376 0 0 0-1.966 5.893c3.236 10.7 8.931 20.293 16.363 28.212a5.376 5.376 0 0 0 6.089 1.239l9.553-4.207a10.746 10.746 0 0 1 9.707.532 10.74 10.74 0 0 1 5.312 8.14l1.14 10.4a5.376 5.376 0 0 0 4.116 4.647c5.204 1.214 10.656 1.932 16.307 1.932 5.65 0 11.099-.715 16.3-1.925a5.376 5.376 0 0 0 4.122-4.654l1.141-10.4a10.74 10.74 0 0 1 5.312-8.14 10.745 10.745 0 0 1 9.7-.532l9.56 4.207a5.376 5.376 0 0 0 6.09-1.24c7.426-7.917 13.125-17.51 16.362-28.21a5.376 5.376 0 0 0-1.966-5.894l-8.476-6.208A10.737 10.737 0 0 1 139.75 86c0-3.432 1.628-6.641 4.395-8.671l8.476-6.208a5.376 5.376 0 0 0 1.966-5.893c-3.237-10.7-8.936-20.295-16.363-28.212a5.376 5.376 0 0 0-6.089-1.239l-9.56 4.207a10.745 10.745 0 0 1-9.7-.532 10.74 10.74 0 0 1-5.312-8.14l-1.14-10.4a5.376 5.376 0 0 0-4.116-4.647C97.103 15.05 91.651 14.333 86 14.333zm0 10.75c3.491 0 6.844.627 10.204 1.218l.672 6.18A21.524 21.524 0 0 0 107.5 48.76a21.51 21.51 0 0 0 19.407 1.064l5.683-2.499a60.413 60.413 0 0 1 10.232 17.644l-5.039 3.695A21.51 21.51 0 0 0 129 86a21.51 21.51 0 0 0 8.783 17.336l5.04 3.695a60.413 60.413 0 0 1-10.233 17.644l-5.683-2.499a21.51 21.51 0 0 0-19.407 1.064 21.524 21.524 0 0 0-10.624 16.279l-.672 6.18c-3.36.59-6.714 1.218-10.204 1.218-3.491 0-6.844-.627-10.204-1.218l-.672-6.18A21.524 21.524 0 0 0 64.5 123.24a21.51 21.51 0 0 0-19.407-1.064l-5.683 2.499a60.372 60.372 0 0 1-10.232-17.644l5.039-3.695A21.51 21.51 0 0 0 43 86a21.535 21.535 0 0 0-8.783-17.343l-5.04-3.695a60.387 60.387 0 0 1 10.24-17.644l5.676 2.499A21.509 21.509 0 0 0 64.5 48.76 21.524 21.524 0 0 0 75.124 32.48l.672-6.18c3.36-.59 6.715-1.218 10.204-1.218zm0 32.25c-15.768 0-28.667 12.899-28.667 28.667 0 15.768 12.898 28.667 28.667 28.667 15.768 0 28.667-12.899 28.667-28.667 0-15.768-12.898-28.667-28.667-28.667zm0 10.75A17.836 17.836 0 0 1 103.917 86 17.836 17.836 0 0 1 86 103.917 17.836 17.836 0 0 1 68.083 86 17.836 17.836 0 0 1 86 68.083z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <span class="MuiTouchRipple-root css-w0pj6f"></span>
              </button>
            </div>
          </div>
        </div>
        <div class="jss615" style="right: calc(100% + 16px)">
          <div class="jss77 w-flat" style="margin-top: 0px">
            <div class="jss79" style="width: 320px">
              <div class="jss324">
                <div class="search-bar">
                  <div class="jss326">
                    <span>Tìm kiếm | 1 đầu số</span>
                  </div>
                  <div
                    input-id="cbd09de0-aa91-11ed-98fc-e5d05b493c4b"
                    class="jss328 jss325 inputWarp flat"
                    style="
                      transition-property: width, boxShadow;
                      transition-duration: 0.25s;
                    "
                  >
                    <div class="jss330">
                      <span
                        style="
                          margin-right: 8px;
                          display: flex;
                          align-items: center;
                          height: 20px;
                        "
                      >
                        <div
                          class="css-vbg4cz css-x8dxwk"
                          width="20"
                          height="20"
                          color="primary"
                          selector="&amp; svg"
                        >
                          <div>
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 20 20"
                              fill="#1e3150"
                              class="injected-svg"
                              data-src="/_next/static/chunks/media/images/ic_search_omi.fb83391128d5abf9f4f4.svg"
                              xmlns:xlink="http://www.w3.org/1999/xlink"
                              role="img"
                              style="height: 100%"
                            >
                              <path
                                d="m12.192 13.586 1.9-2 2.9 2.9c.6.5.6 1.4.1 2a1.52 1.52 0 0 1-2 0l-2.9-2.9zM2 8a6.02 6.02 0 0 1 6-6c1.1 0 2.1.3 3 .8v3c-1.2-1.7-3.6-2-5.2-.8s-2 3.6-.8 5.2 3.6 2 5.2.8c.3-.2.6-.5.8-.8v2.9c-2.9 1.8-6.5.8-8.2-2.1-.5-.9-.8-1.9-.8-3z"
                              ></path>
                              <path
                                d="M11.2 11.2c.8-.8 1.3-2 1.3-3.2s-.5-2.3-1.3-3.2V2.9C12.9 4 14 5.9 14 8s-1.1 4-2.8 5.1v-1.9z"
                                opacity=".3"
                              ></path>
                            </svg>
                          </div>
                        </div>
                      </span>
                      <div class="jss331">
                        <input
                          placeholder="Tìm kiếm | 1 đầu số"
                          class="jss332 search-number-call"
                          value=""
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="scrollable-y"
              style="padding: 8px; max-height: 204px; min-height: 72px"
            >
              <div class="jss78 option-phone"></div>
            </div>
          </div>
        </div>

        <div class="jss777" style="right: calc(100% + 16px)">
          <div class="jss77 w-flat" style="margin-top: 0px">
            <div class="jss79 d-none w-680px">
              <div class="custom-watch"></div>
            </div>
            <div
              class="custom-calendar w-680px h-500px ms-2 mt-4 mb-2 me-2"
              id="custom-calendar"
            ></div>
          </div>
        </div>

        <div class="jss610" style="right: calc(100% + 16px)">
          <div class="jss77 w-flat" style="margin-top: 0px">
            <div class="jss79" style="width: 320px">
              <div class="jss324">
                <div class="search-bar">
                  <div class="jss326">
                    <span>Tìm kiếm | Tên hoặc số điện thoại</span>
                  </div>
                  <div
                    input-id="b61ccaf0-aa96-11ed-98fc-e5d05b493c4b"
                    class="jss328 jss325 inputWarp flat"
                    style="
                      width: 271px;
                      transition-property: width, boxShadow;
                      transition-duration: 0.25s;
                    "
                  >
                    <div class="jss330">
                      <span
                        style="
                          margin-right: 8px;
                          display: flex;
                          align-items: center;
                          height: 20px;
                        "
                      >
                        <div
                          class="css-vbg4cz css-x8dxwk"
                          width="20"
                          height="20"
                          color="primary"
                          selector="&amp; svg"
                        >
                          <div>
                            <svg
                              xmlns="http://www.w3.org/2000/svg"
                              viewBox="0 0 20 20"
                              fill="#1e3150"
                              class="injected-svg"
                              data-src="/_next/static/chunks/media/images/ic_search_omi.fb83391128d5abf9f4f4.svg"
                              xmlns:xlink="http://www.w3.org/1999/xlink"
                              role="img"
                              style="height: 100%"
                            >
                              <path
                                d="m12.192 13.586 1.9-2 2.9 2.9c.6.5.6 1.4.1 2a1.52 1.52 0 0 1-2 0l-2.9-2.9zM2 8a6.02 6.02 0 0 1 6-6c1.1 0 2.1.3 3 .8v3c-1.2-1.7-3.6-2-5.2-.8s-2 3.6-.8 5.2 3.6 2 5.2.8c.3-.2.6-.5.8-.8v2.9c-2.9 1.8-6.5.8-8.2-2.1-.5-.9-.8-1.9-.8-3z"
                              ></path>
                              <path
                                d="M11.2 11.2c.8-.8 1.3-2 1.3-3.2s-.5-2.3-1.3-3.2V2.9C12.9 4 14 5.9 14 8s-1.1 4-2.8 5.1v-1.9z"
                                opacity=".3"
                              ></path>
                            </svg>
                          </div>
                        </div>
                      </span>
                      <div class="jss331">
                        <input
                          placeholder="Tìm kiếm | Tên hoặc số điện thoại"
                          class="jss332 input-search-info-customer"
                          value=""
                        />
                      </div>
                    </div>
                  </div>
                  <div>
                    <button
                      class="MuiButtonBase-root MuiButton-root success contained rounded light MuiButton-contained MuiButton-sizeMedium jss72 medium colorful MuiButton-containedSuccess MuiButton-containedSizeMedium css-1dzu0g4 animate__fadeInLeft"
                      tabindex="0"
                      type="button"
                      style="
                        min-width: unset;
                        box-shadow: none;
                        line-height: normal;
                        border-radius: 12px;
                        text-transform: none;
                        letter-spacing: normal;
                        font-size: 15px;
                        padding: 0px;
                      "
                    >
                      <div
                        class="css-17xyljb css-18l4zr9"
                        width="20"
                        height="20"
                      >
                        <div>
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 172 172"
                            class="injected-svg"
                            data-src="/_next/static/chunks/media/images/ic_add_filled.e6a18d22722d6997abc5.svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink"
                            role="img"
                            style="height: 100%"
                          >
                            <g
                              fill="none"
                              stroke-miterlimit="10"
                              font-family="none"
                              font-weight="none"
                              font-size="none"
                              text-anchor="none"
                              style="mix-blend-mode: normal"
                            >
                              <path d="M0 172V0h172v172z"></path>
                              <path
                                d="M86 14.333c-39.517 0-71.667 32.15-71.667 71.667S46.483 157.667 86 157.667s71.667-32.15 71.667-71.667S125.517 14.333 86 14.333zm30.458 77.042H91.375v25.083a5.375 5.375 0 1 1-10.75 0V91.375H55.542a5.375 5.375 0 1 1 0-10.75h25.083V55.542a5.375 5.375 0 1 1 10.75 0v25.083h25.083a5.375 5.375 0 1 1 0 10.75z"
                                fill="#1e3150"
                              ></path>
                            </g>
                          </svg>
                        </div>
                      </div>
                      <span class="MuiTouchRipple-root css-w0pj6f"></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="scrollable-y search-info-customer"
              style="padding: 8px; max-height: 204px; min-height: 50px"
            >
              <div
                class="jss78 search-info-customer"
                data-phone=""
                onclick="noUseFastCallAndCickFastCall(this)"
                onmouseover="onmouseoverNoUserFastCall(this)"
                onmouseout="onmouseoutNoUserFastCall(this)"
              >
                <div class="jss87 active">
                  <div class="css-17xyljb" width="20" height="20">
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <span>Không áp dụng</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="jss492"
          style="right: calc(100% + 16px); display: none"
          id="modal-pad-number"
        >
          <div class="jss494">
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="1"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">1</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="2"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">2</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="3"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">3</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="4"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">4</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="5"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">5</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="6"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">6</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="7"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">7</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="8"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">8</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="9"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">9</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="*"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">*</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="0"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">0</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
            <button
              class="pad-value MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root btn-pad-number MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
              tabindex="0"
              type="button"
              value="#"
              onclick="addNumber(this)"
              style="
                min-width: unset;
                width: 48px;
                box-shadow: none;
                line-height: normal;
                border-radius: 6px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                height: 48px;
              "
            >
              <span class="text">#</span>
              <span class="MuiTouchRipple-root css-w0pj6f"></span>
            </button>
          </div>
        </div>

        <div
          class="jss492"
          style="right: calc(100% + 16px); display: none"
          id="modal-change-status-extension"
        >
          <div id="top_status-options-flat">
            <a
              id="status-online"
              data-status="1"
              data-id="1"
              data-color="2ecc71"
              class="active"
            >
              <span class="status-circle"></span>
              Trực tuyến
            </a>
            <a
              id="status-away"
              data-status="2"
              data-id="2"
              data-color="f1c40f"
              class=""
            >
              <span class="status-circle"></span>
              Đi vắng
            </a>
            <a
              id="status-busy"
              data-status="3"
              data-id="3"
              data-color="e74c3c"
              class=""
            >
              <span class="status-circle"></span>
              Bận
            </a>
            <a
              id="status-offline"
              data-status="4"
              data-id="4"
              data-color="95a5a6"
              class=""
            >
              <span class="status-circle"></span>
              Ngoại tuyến
            </a>
          </div>
        </div>
        <div
          role="tooltip"
          class="css-0 MuiPopperUnstyled-root multi-settings"
          style="
            position: absolute;
            inset: auto 0px 0px auto;
            z-index: 9999;
            margin: 0px;
            transform: translate3d(-40px, -82px, 0px);
          "
          data-popper-placement="top-end"
        >
          <div class="jss1804" style="margin: 0px 0px 8px; width: 242px">
            <span>Tùy chọn</span>
            <div class="scrollable-y" style="padding: 8px; max-height: 228px">
              <div class="jss1805">
                <div class="jss1808" style="height: 36px">
                  <div
                    class="css-17xyljb css-1lrnpvo"
                    width="20"
                    height="20"
                    color="primary"
                    style="margin-right: 8px"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_square_uncheck.4bb9c336881496d219e2.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M41.208 21.5c-10.82 0-19.708 8.887-19.708 19.708v89.584c0 10.82 8.887 19.708 19.708 19.708h89.584c10.82 0 19.708-8.887 19.708-19.708V41.208c0-10.82-8.887-19.708-19.708-19.708zm0 10.75h89.584c5.01 0 8.958 3.948 8.958 8.958v89.584c0 5.01-3.948 8.958-8.958 8.958H41.208c-5.01 0-8.958-3.948-8.958-8.958V41.208c0-5.01 3.948-8.958 8.958-8.958z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <div class="wrapper">
                    <div class="container">
                      <div>
                        <div class="startItem">
                          <span class="label">Ưu tiên gọi nội mạng</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jss1808" style="height: 36px">
                  <div
                    class="css-17xyljb css-1lrnpvo"
                    width="20"
                    height="20"
                    color="primary"
                    style="margin-right: 8px"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_square_uncheck.4bb9c336881496d219e2.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M41.208 21.5c-10.82 0-19.708 8.887-19.708 19.708v89.584c0 10.82 8.887 19.708 19.708 19.708h89.584c10.82 0 19.708-8.887 19.708-19.708V41.208c0-10.82-8.887-19.708-19.708-19.708zm0 10.75h89.584c5.01 0 8.958 3.948 8.958 8.958v89.584c0 5.01-3.948 8.958-8.958 8.958H41.208c-5.01 0-8.958-3.948-8.958-8.958V41.208c0-5.01 3.948-8.958 8.958-8.958z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <div class="wrapper">
                    <div class="container">
                      <div>
                        <div class="startItem">
                          <span class="label">Random đầu số gọi ra</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jss1808" style="height: 36px">
                  <div
                    class="css-17xyljb css-1lrnpvo"
                    width="20"
                    height="20"
                    color="primary"
                    style="margin-right: 8px"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_square_uncheck.4bb9c336881496d219e2.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M41.208 21.5c-10.82 0-19.708 8.887-19.708 19.708v89.584c0 10.82 8.887 19.708 19.708 19.708h89.584c10.82 0 19.708-8.887 19.708-19.708V41.208c0-10.82-8.887-19.708-19.708-19.708zm0 10.75h89.584c5.01 0 8.958 3.948 8.958 8.958v89.584c0 5.01-3.948 8.958-8.958 8.958H41.208c-5.01 0-8.958-3.948-8.958-8.958V41.208c0-5.01 3.948-8.958 8.958-8.958z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <div class="wrapper">
                    <div class="container">
                      <div>
                        <div class="startItem">
                          <span class="label">LazyCall cuộc gọi đến</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jss1808" style="height: 36px">
                  <div
                    class="css-17xyljb css-1lrnpvo"
                    width="20"
                    height="20"
                    color="primary"
                    style="margin-right: 8px"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_square_uncheck.4bb9c336881496d219e2.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M41.208 21.5c-10.82 0-19.708 8.887-19.708 19.708v89.584c0 10.82 8.887 19.708 19.708 19.708h89.584c10.82 0 19.708-8.887 19.708-19.708V41.208c0-10.82-8.887-19.708-19.708-19.708zm0 10.75h89.584c5.01 0 8.958 3.948 8.958 8.958v89.584c0 5.01-3.948 8.958-8.958 8.958H41.208c-5.01 0-8.958-3.948-8.958-8.958V41.208c0-5.01 3.948-8.958 8.958-8.958z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <div class="wrapper">
                    <div class="container">
                      <div>
                        <div class="startItem">
                          <span class="label">LazyCall cuộc gọi đi</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="jss1808" style="height: 36px">
                  <div
                    class="css-17xyljb css-1lrnpvo"
                    width="20"
                    height="20"
                    color="primary"
                    style="margin-right: 8px"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_square_uncheck.4bb9c336881496d219e2.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M41.208 21.5c-10.82 0-19.708 8.887-19.708 19.708v89.584c0 10.82 8.887 19.708 19.708 19.708h89.584c10.82 0 19.708-8.887 19.708-19.708V41.208c0-10.82-8.887-19.708-19.708-19.708zm0 10.75h89.584c5.01 0 8.958 3.948 8.958 8.958v89.584c0 5.01-3.948 8.958-8.958 8.958H41.208c-5.01 0-8.958-3.948-8.958-8.958V41.208c0-5.01 3.948-8.958 8.958-8.958z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <div class="wrapper">
                    <div class="container">
                      <div>
                        <div class="startItem">
                          <span class="label">
                            Remote Call&nbsp;
                            <span
                              aria-label="Cuộc gọi sẽ thực hiện trực tiếp trên IP Phone, Softphone"
                              class=""
                            >
                              (?)
                            </span>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="session-btn-right" class="jss2161 right">
        <div
          id="quick-action-wrapper"
          class="jss2509"
          style="right: 0px; animation-duration: 2s"
        >
          <button
            class="btn-on-off-pad info hbg-white colorful contained rounded shadow css-qkyvyh"
            tabindex="0"
            type="button"
            aria-label="Thực hiện cuộc gọi"
            style="
              min-width: unset;
              width: 56px;
              box-shadow: none;
              line-height: normal;
              border-radius: 12px;
              text-transform: none;
              letter-spacing: normal;
              font-size: 15px;
              padding: 0px;
              height: 56px;
            "
            onclick="btnOnModalCall()"
          >
            <div
              draggable="false"
              class="css-chn1mj css-og6xnq"
              width="24px"
              height="24px"
              color="white"
            >
              <div>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 172 172"
                  class="injected-svg"
                  data-src="/_next/static/chunks/media/images/ic_phone_filled.251aab66be05671ffa54.svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  role="img"
                  style="height: 100%"
                >
                  <g
                    fill="none"
                    stroke-miterlimit="10"
                    font-family="none"
                    font-weight="none"
                    font-size="none"
                    text-anchor="none"
                    style="mix-blend-mode: normal"
                  >
                    <path d="M0 172V0h172v172z"></path>
                    <path
                      d="m82.116 23.74 6.16 14.53c2.683 6.332 1.196 13.778-3.684 18.408L73.082 67.6c-1.297 1.232-1.97 3.02-1.68 4.783 1.11 6.74 3.572 13.388 7.385 19.945 3.805 6.543 8.438 12.112 13.903 16.702 1.448 1.215 3.458 1.53 5.25.932l13.426-4.48c6.182-2.06 12.911.309 16.702 5.877l8.833 12.975c4.408 6.476 3.616 15.405-1.852 20.895l-5.863 5.884c-5.833 5.855-14.165 7.98-21.872 5.575-18.197-5.676-34.924-22.524-50.189-50.55-15.286-28.064-20.679-51.88-16.182-71.437 1.892-8.23 7.75-14.785 15.401-17.229l7.715-2.465c7.239-2.304 14.96 1.43 18.057 8.733z"
                      fill="#1e3150"
                    ></path>
                  </g>
                </svg>
              </div>
            </div>
            <span class="MuiTouchRipple-root css-w0pj6f"></span>
          </button>
        </div>
      </div>
    </div>
    <div id="Click2call"></div>
    <div id="root"></div>
    <div id="modal_ticket"></div>
    <div class="info-call">
      <div
        class="jss393 react-draggable"
        style="
          min-width: 400px;
          height: 442px;
          z-index: 1213;
          left: 50%;
          top: 50%;
          transform: translate(-50%, -50%);
        "
      >
        <div
          class="jss394 connecting outbound"
          style="min-width: 372px; height: 442px"
        >
          <div class="jss396">
            <div class="jss397">
              <div>
                <div
                  class="css-17xyljb css-og6xnq"
                  width="20"
                  height="20"
                  color="white"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_outbound.2a76ea82b0313497a58a.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M127.152 14.277a5.376 5.376 0 0 0-3.744 9.232l12.325 12.324H94.958a5.376 5.376 0 1 0 0 10.75h40.775l-12.325 12.325a5.376 5.376 0 1 0 7.6 7.6l21.5-21.5a5.376 5.376 0 0 0 0-7.6l-21.5-21.5a5.376 5.376 0 0 0-3.856-1.63zm-79.148.098c-1.79-.139-3.63.06-5.438.637l-7.712 2.47c-7.65 2.445-13.513 8.994-15.405 17.225-4.497 19.557.899 43.367 16.174 71.428 15.265 28.026 31.992 44.876 50.188 50.552 7.708 2.404 16.044.284 21.878-5.571l5.858-5.886c5.468-5.49 6.262-14.423 1.855-20.898l-8.833-12.976c-3.791-5.568-10.524-7.932-16.706-5.872l-13.423 4.48c-1.792.598-3.802.283-5.25-.931-5.464-4.59-10.1-10.163-13.906-16.706-3.812-6.558-6.272-13.206-7.383-19.946-.29-1.763.382-3.548 1.68-4.78l11.512-10.926c4.88-4.63 6.365-12.074 3.682-18.406l-6.16-14.53c-2.321-5.477-7.243-8.946-12.61-9.364z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <div class="jss389 nodrag info-number-call"></div>
                <span class="nodrag" id="time-start-call"></span>
              </div>
              <button
                class="MuiButtonBase-root MuiButton-root jss79 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root jss79 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
                tabindex="0"
                type="button"
                style="
                  min-width: unset;
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-og6xnq"
                  width="20"
                  height="20"
                  color="white"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_settings.5b3c855b55461fad50a1.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M86 14.333c-5.65 0-11.099.715-16.3 1.925a5.376 5.376 0 0 0-4.122 4.654l-1.141 10.4a10.744 10.744 0 0 1-15.012 8.664h-.007l-9.553-4.206a5.376 5.376 0 0 0-6.09 1.246C26.35 44.934 20.65 54.521 17.414 65.221a5.376 5.376 0 0 0 1.966 5.893l8.476 6.215A10.746 10.746 0 0 1 32.25 86c0 3.432-1.628 6.641-4.395 8.671l-8.476 6.208a5.376 5.376 0 0 0-1.966 5.893c3.236 10.7 8.931 20.293 16.363 28.212a5.376 5.376 0 0 0 6.089 1.239l9.553-4.207a10.746 10.746 0 0 1 9.707.532 10.74 10.74 0 0 1 5.312 8.14l1.14 10.4a5.376 5.376 0 0 0 4.116 4.647c5.204 1.214 10.656 1.932 16.307 1.932 5.65 0 11.099-.715 16.3-1.925a5.376 5.376 0 0 0 4.122-4.654l1.141-10.4a10.74 10.74 0 0 1 5.312-8.14 10.745 10.745 0 0 1 9.7-.532l9.56 4.207a5.376 5.376 0 0 0 6.09-1.24c7.426-7.917 13.125-17.51 16.362-28.21a5.376 5.376 0 0 0-1.966-5.894l-8.476-6.208A10.737 10.737 0 0 1 139.75 86c0-3.432 1.628-6.641 4.395-8.671l8.476-6.208a5.376 5.376 0 0 0 1.966-5.893c-3.237-10.7-8.936-20.295-16.363-28.212a5.376 5.376 0 0 0-6.089-1.239l-9.56 4.207a10.745 10.745 0 0 1-9.7-.532 10.74 10.74 0 0 1-5.312-8.14l-1.14-10.4a5.376 5.376 0 0 0-4.116-4.647C97.103 15.05 91.651 14.333 86 14.333zm0 10.75c3.491 0 6.844.627 10.204 1.218l.672 6.18A21.524 21.524 0 0 0 107.5 48.76a21.51 21.51 0 0 0 19.407 1.064l5.683-2.499a60.413 60.413 0 0 1 10.232 17.644l-5.039 3.695A21.51 21.51 0 0 0 129 86a21.51 21.51 0 0 0 8.783 17.336l5.04 3.695a60.413 60.413 0 0 1-10.233 17.644l-5.683-2.499a21.51 21.51 0 0 0-19.407 1.064 21.524 21.524 0 0 0-10.624 16.279l-.672 6.18c-3.36.59-6.714 1.218-10.204 1.218-3.491 0-6.844-.627-10.204-1.218l-.672-6.18A21.524 21.524 0 0 0 64.5 123.24a21.51 21.51 0 0 0-19.407-1.064l-5.683 2.499a60.372 60.372 0 0 1-10.232-17.644l5.039-3.695A21.51 21.51 0 0 0 43 86a21.535 21.535 0 0 0-8.783-17.343l-5.04-3.695a60.387 60.387 0 0 1 10.24-17.644l5.676 2.499A21.509 21.509 0 0 0 64.5 48.76 21.524 21.524 0 0 0 75.124 32.48l.672-6.18c3.36-.59 6.715-1.218 10.204-1.218zm0 32.25c-15.768 0-28.667 12.899-28.667 28.667 0 15.768 12.898 28.667 28.667 28.667 15.768 0 28.667-12.899 28.667-28.667 0-15.768-12.898-28.667-28.667-28.667zm0 10.75A17.836 17.836 0 0 1 103.917 86 17.836 17.836 0 0 1 86 103.917 17.836 17.836 0 0 1 68.083 86 17.836 17.836 0 0 1 86 68.083z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
                <span class="MuiTouchRipple-root css-w0pj6f"></span>
              </button>
            </div>
            <div class="jss395"></div>
            <div class="jss398">
              <div class="jss420">
                <div style="opacity: 0.5">
                  <div
                    class="css-17xyljb css-og6xnq"
                    width="20"
                    height="20"
                    color="white"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <span>Không áp dụng</span>
                </div>
                <span class="anim-fh jss421">Thay đổi</span>
              </div>
              <div class="jss399">
                <div class="jss400">
                  <div
                    class="jss82 nodrag"
                    style="
                      width: 32px;
                      min-width: 32px;
                      height: 32px;
                      min-height: 32px;
                      background-color: rgba(232, 42, 143, 0.3);
                      opacity: 1;
                      cursor: pointer;
                    "
                  >
                    <div
                      style="
                        position: absolute;
                        display: flex;
                        justify-content: center;
                        width: 104%;
                      "
                    >
                      <img
                        alt=""
                        draggable="false"
                        class="css-1rtqv6b img-customer-calling-bigg"
                        width="70%"
                        height="70%"
                        src=""
                        id=""
                      />
                    </div>
                  </div>
                </div>
                <div>
                  <p
                    class="nodrag name-customer-calling"
                    id="getName"
                    style="cursor: pointer"
                  >
                    Không xác định
                  </p>
                  <span
                    class="nodrag phone-customer-calling"
                    id="getPhone"
                    style="opacity: 1; cursor: pointer"
                  ></span>
                </div>
              </div>
              <div class="jss401 d-flex gap-3">
                <button
                  class="MuiButtonBase-root MuiButton-root jss79 nodrag medium success hbg-white colorful contained rounded MuiButton-contained MuiButton-containedSuccess MuiButton-sizeMedium MuiButton-containedSizeMedium MuiButton-root jss79 nodrag medium success hbg-white colorful contained rounded MuiButton-contained MuiButton-containedSuccess MuiButton-sizeMedium MuiButton-containedSizeMedium css-1dzu0g4"
                  tabindex="0"
                  type="button"
                  aria-label="Thêm khách hàng"
                  onclick="openModal()"
                  ;
                  style="
                    min-width: unset;
                    box-shadow: none;
                    line-height: normal;
                    border-radius: 12px;
                    text-transform: none;
                    letter-spacing: normal;
                    font-size: 15px;
                    padding: 0px;
                  "
                >
                  <div
                    draggable="false"
                    class="css-17xyljb css-og6xnq"
                    width="20"
                    height="20"
                    color="white"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_add_user_male_filled.4fe1dafd94ad947a15f0.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M60.917 7.167C41.158 7.167 25.083 23.242 25.083 43c0 19.759 16.075 35.833 35.834 35.833C80.675 78.833 96.75 62.758 96.75 43c0-19.759-16.075-35.833-35.833-35.833zM125.417 86C103.647 86 86 103.648 86 125.417c0 21.768 17.648 39.416 39.417 39.416 21.768 0 39.416-17.648 39.416-39.416 0-21.77-17.648-39.417-39.416-39.417zm-103.12 7.167c-7.352 0-13.339 6.394-13.339 14.256v5.452c0 11.757 6.075 21.974 17.112 28.765 9.285 5.715 21.66 8.86 34.847 8.86 7.847 0 15.88-1.162 23.214-3.548a46.347 46.347 0 0 1-5.298-21.535c0-12.528 4.97-23.88 13.018-32.25zm103.12 3.583a3.585 3.585 0 0 1 3.583 3.583v21.5h21.5a3.585 3.585 0 0 1 3.583 3.584A3.585 3.585 0 0 1 150.5 129H129v21.5a3.585 3.585 0 0 1-3.583 3.583 3.585 3.585 0 0 1-3.584-3.583V129h-21.5a3.585 3.585 0 0 1-3.583-3.583 3.585 3.585 0 0 1 3.583-3.584h21.5v-21.5a3.585 3.585 0 0 1 3.584-3.583z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <span class="MuiTouchRipple-root css-w0pj6f"></span>
                </button>

                <button
                  onclick="openModalTickets()"
                  class="MuiButtonBase-root MuiButton-root jss72 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root jss72 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
                  tabindex="0"
                  type="button"
                  aria-label="Phiếu ghi"
                  style="
                    min-width: unset;
                    box-shadow: none;
                    line-height: normal;
                    border-radius: 12px;
                    text-transform: none;
                    letter-spacing: normal;
                    font-size: 15px;
                    padding: 0px;
                  "
                >
                  <div
                    draggable="false"
                    class="css-17xyljb css-og6xnq"
                    width="20"
                    height="20"
                    color="white"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_ticket_filled.8a30029d3532ef477d02.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M156.233 66.4c2.831-.18 5.017-2.545 5.017-5.376V48.375c0-6.916-5.626-12.542-12.542-12.542H118.25V43c0 2.974-2.4 5.375-5.375 5.375A5.368 5.368 0 0 1 107.5 43v-7.167H23.292c-6.916 0-12.542 5.626-12.542 12.542v12.65c0 2.83 2.186 5.195 5.017 5.374C26.015 67.044 34.042 75.68 34.042 86c0 10.32-8.027 18.956-18.275 19.6-2.831.18-5.017 2.545-5.017 5.376v12.649c0 6.916 5.626 12.542 12.542 12.542H107.5V129c0-2.974 2.4-5.375 5.375-5.375 2.974 0 5.375 2.4 5.375 5.375v7.167h30.458c6.916 0 12.542-5.626 12.542-12.542v-12.65c0-2.83-2.186-5.195-5.017-5.374-10.248-.645-18.275-9.281-18.275-19.601 0-10.32 8.027-18.956 18.275-19.6zm-37.983 41.1c0 2.974-2.4 5.375-5.375 5.375a5.368 5.368 0 0 1-5.375-5.375V96.75c0-2.974 2.4-5.375 5.375-5.375 2.974 0 5.375 2.4 5.375 5.375zm0-32.25c0 2.974-2.4 5.375-5.375 5.375a5.368 5.368 0 0 1-5.375-5.375V64.5c0-2.974 2.4-5.375 5.375-5.375 2.974 0 5.375 2.4 5.375 5.375z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <span class="MuiTouchRipple-root css-w0pj6f"></span>
                </button>
              </div>
              <div class="jss402">
                <span class="nodrag">Chưa có ghi chú gần nhất</span>
              </div>
              <div class="jss404" style="margin-top: unset">
                <button
                  class="MuiButtonBase-root MuiButton-root jss79 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium MuiButton-root jss79 nodrag medium hbg-white rounded MuiButton-Primary MuiButton-sizeMedium MuiButton-SizeMedium css-1bvttbo"
                  tabindex="0"
                  type="button"
                  aria-label="Thu nhỏ"
                  onclick="collapseModalInfoCall()"
                  style="
                    min-width: unset;
                    box-shadow: none;
                    line-height: normal;
                    border-radius: 12px;
                    text-transform: none;
                    letter-spacing: normal;
                    font-size: 15px;
                    padding: 0px;
                    margin-top: auto;
                  "
                >
                  <div
                    draggable="false"
                    class="css-17xyljb css-og6xnq"
                    width="20"
                    height="20"
                    color="white"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_compress.ca671674692f903ee31e.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M152.187 14.284a5.376 5.376 0 0 0-3.696 1.624l-44.574 44.575V23.292a5.376 5.376 0 1 0-10.75 0v50.166a5.376 5.376 0 0 0 5.375 5.375h50.166a5.376 5.376 0 1 0 0-10.75h-37.19l44.574-44.574a5.376 5.376 0 0 0-3.905-9.225zM73.353 93.118a5.376 5.376 0 0 0-.574.049H23.292a5.376 5.376 0 1 0 0 10.75h37.19L15.909 148.49a5.376 5.376 0 1 0 7.6 7.601l44.575-44.575v37.191a5.376 5.376 0 1 0 10.75 0V99.165a5.376 5.376 0 0 0-5.48-6.047z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                  <span class="MuiTouchRipple-root css-w0pj6f"></span>
                </button>
              </div>
            </div>
          </div>
          <div class="jss395"></div>
          <div class="jss407">
            <div class="jss409">
              <div>
                <div style="padding-bottom: 5px" class="speedInternet">
                  <span
                    class="nodrag speed-internet-in-call-big animate__animated animate__fadeInLeft"
                    id="status-watch-in-call-big"
                  >
                    Đang trong cuộc gọi...</span
                  >
                  <span
                    class="nodrag speed-internet-in-call-small animate__animated animate__fadeInLeft"
                    id="speedInternet"
                  >
                    <div>
                      <div class="col"></div>
                      <div class="col"></div>
                      <div class="col"></div>
                    </div>
                    <span
                      class="internetSpeedRealtime"
                      id="internetSpeedRealtime"
                    ></span>
                  </span>

                  <div
                    class="css-17xyljb css-1fvhrr5 icon-status-count"
                    width="20"
                    height="20"
                    color="error"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_missed_call_filled.43703a336d635872c273.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M130.806 21.444a5.374 5.374 0 0 0-.7.056h-20.814a5.376 5.376 0 1 0 0 10.75h8.111L85.881 62.435 52.084 30.157a5.376 5.376 0 1 0-7.418 7.769l37.513 35.833a5.376 5.376 0 0 0 7.425 0l35.813-34.293v8.909a5.376 5.376 0 1 0 10.75 0V27.603a5.376 5.376 0 0 0-5.361-6.159zM86 89.584c-34.074 0-53.021 9.852-62.918 18.119-6.848 5.726-9.976 14.901-8.238 23.67.04.1 1.834 6.704 1.834 6.704 1.924 7.307 8.797 12.409 16.713 12.409.856 0 1.72-.06 2.568-.182l16.174-2.303c5.404-.77 9.803-4.7 10.946-9.777l3.192-14.137c.433-1.92 1.897-3.452 3.821-4.003 2.938-.835 8.078-1.834 15.908-1.834s12.966.999 15.901 1.834c1.924.548 3.395 2.079 3.828 4.003l3.185 14.137c1.146 5.078 5.542 9.007 10.946 9.777l16.18 2.303c.85.122 1.716.182 2.57.182 7.918 0 14.791-5.099 16.712-12.409 0 0 1.777-6.56 1.813-6.634 1.774-8.79-1.358-18-8.224-23.74-9.89-8.267-28.837-18.12-62.911-18.12z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                </div>

                <span
                  class="nodrag count-watch-in-call-big animate__animated animate__fadeInLeft"
                  id="count-watch-in-call-big"
                  >Đang kết nối...</span
                >
              </div>
              <button
                class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh btn-accept-call-big"
                tabindex="0"
                type="button"
                onclick="acceptCall()"
                id="btn-accept-call-big"
                style="
                  min-width: unset;
                  background-color: rgb(86, 204, 110);
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
                autocomplete="off"
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_phone_filled.251aab66be05671ffa54.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="m82.116 23.74 6.16 14.53c2.683 6.332 1.196 13.778-3.684 18.408L73.082 67.6c-1.297 1.232-1.97 3.02-1.68 4.783 1.11 6.74 3.572 13.388 7.385 19.945 3.805 6.543 8.438 12.112 13.903 16.702 1.448 1.215 3.458 1.53 5.25.932l13.426-4.48c6.182-2.06 12.911.309 16.702 5.877l8.833 12.975c4.408 6.476 3.616 15.405-1.852 20.895l-5.863 5.884c-5.833 5.855-14.165 7.98-21.872 5.575-18.197-5.676-34.924-22.524-50.189-50.55-15.286-28.064-20.679-51.88-16.182-71.437 1.892-8.23 7.75-14.785 15.401-17.229l7.715-2.465c7.239-2.304 14.96 1.43 18.057 8.733z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
              </button>
            </div>
            <div></div>
            <button
              class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh btn-end-call-big"
              tabindex="0"
              type="button"
              onclick="endCallTemp()"
              id="btn-end-call-big"
              style="
                background-color: #dc143c;
                box-shadow: none;
                line-height: normal;
                border-radius: 12px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                padding: 0px;
              "
              autocomplete="off"
            >
              <div
                draggable="false"
                class="css-17xyljb css-1lrnpvo"
                width="20"
                height="20"
                color="primary"
              >
                <div>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 172 172"
                    class="injected-svg"
                    data-src="/_next/static/chunks/media/images/ic_end_call_filled.51f030ab462d36de0350.svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    role="img"
                    style="height: 100%"
                  >
                    <g
                      fill="none"
                      stroke-miterlimit="10"
                      font-family="none"
                      font-weight="none"
                      font-size="none"
                      text-anchor="none"
                      style="mix-blend-mode: normal"
                    >
                      <path d="M0 172V0h172v172z"></path>
                      <path
                        d="M86 17.917c-29.835-.04-49.988 6.278-64.031 18.658-5.909 5.21-8.68 12.922-7.279 20.275l1.414 7.419c1.326 6.952 7.834 11.62 15.201 10.911l14.662-1.414c6.393-.616 11.84-5.149 13.466-11.205l4.451-15.299C70.581 44.517 78.834 43 86 43c7.167 0 14.66 1.332 21.353 4.073l4.458 15.3c1.627 6.055 7.077 10.588 13.466 11.204l14.662 1.414c7.367.71 13.868-3.952 15.194-10.904l1.414-7.419c1.401-7.353-1.363-15.072-7.272-20.282-14.04-12.384-33.44-18.43-63.275-18.47zm-.084 53.673a5.376 5.376 0 0 0-5.291 5.452v58.69l-14.116-14.116a5.376 5.376 0 1 0-7.601 7.601L82.2 152.509a5.376 5.376 0 0 0 7.6 0l23.292-23.292a5.376 5.376 0 1 0-7.6-7.6l-14.117 14.116V77.042a5.375 5.375 0 0 0-5.459-5.452z"
                        fill="#1e3150"
                      ></path>
                    </g>
                  </svg>
                </div>
              </div>
            </button>
            <button
              class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh btn-ended-call"
              tabindex="0"
              type="button"
              onclick="endCall()"
              id="btn-ended-call-big"
              style="
                width: 75px;
                background-color: rgb(86, 204, 110);
                box-shadow: none;
                line-height: normal;
                border-radius: 12px;
                text-transform: none;
                letter-spacing: normal;
                font-size: 15px;
                padding: 0px;
              "
              autocomplete="off"
            >
              <div>
                <span> Đóng </span>
              </div>
            </button>
          </div>
        </div>

        <div class="jss860 nodrag ticket-modal-right">
          <div class="jss863" onclick="toggleTickerRight()">
            <div class="jss859">
              <div
                class="css-iamfhq css-1lrnpvo"
                width="12px"
                height="12px"
                color="primary"
              >
                <div>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 172 172"
                    class="injected-svg"
                    data-src="/_next/static/chunks/media/images/ic_sort_right_filled.188a7a40c44414fcd86a.svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    role="img"
                    style="height: 100%"
                  >
                    <g
                      fill="none"
                      stroke-miterlimit="10"
                      font-family="none"
                      font-weight="none"
                      font-size="none"
                      text-anchor="none"
                      style="mix-blend-mode: normal"
                    >
                      <path d="M0 172V0h172v172z"></path>
                      <path
                        d="M49.575 29.222a5.376 5.376 0 0 0-2.992 4.82v103.916a5.376 5.376 0 0 0 5.375 5.375 5.354 5.354 0 0 0 3.261-1.103l68.084-51.959a5.37 5.37 0 0 0 0-8.542L55.219 29.77a5.389 5.389 0 0 0-5.644-.548z"
                        fill="#1e3150"
                      ></path>
                    </g>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="screen-small" style="font-size: 12px">
      <div
        class="jss605 minimize react-draggable react-draggable-dragged"
        style="
          min-width: 610px;
          height: 72px;
          z-index: 100113;
          margin-top: 0px;
          margin-left: 0px;
          position: fixed !important;
        "
      >
        <div
          class="jss606 ended outbound"
          style="min-width: 610px; height: 72px"
        >
          <div class="jss607"></div>
          <div class="jss619">
            <div class="jss617 nodrag">
              <div>
                <div class="jss626" onclick="enlargeModalInfoCall()">
                  <div
                    class="css-iamfhq css-og6xnq"
                    width="12px"
                    height="12px"
                    color="white"
                  >
                    <div>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 172 172"
                        class="injected-svg"
                        data-src="/_next/static/chunks/media/images/ic_sort_right_filled.188a7a40c44414fcd86a.svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                        role="img"
                        style="height: 100%"
                      >
                        <g
                          fill="none"
                          stroke-miterlimit="10"
                          font-family="none"
                          font-weight="none"
                          font-size="none"
                          text-anchor="none"
                          style="mix-blend-mode: normal"
                        >
                          <path d="M0 172V0h172v172z"></path>
                          <path
                            d="M49.575 29.222a5.376 5.376 0 0 0-2.992 4.82v103.916a5.376 5.376 0 0 0 5.375 5.375 5.354 5.354 0 0 0 3.261-1.103l68.084-51.959a5.37 5.37 0 0 0 0-8.542L55.219 29.77a5.389 5.389 0 0 0-5.644-.548z"
                            fill="#1e3150"
                          ></path>
                        </g>
                      </svg>
                    </div>
                  </div>
                </div>
                <div class="jss611">
                  <div
                    class="jssNew111 displayFlex"
                    style="margin-left: 16px; justify-content: space-around"
                  >
                    <div class="displayFlex" style="font-size: 12px; gap: 2">
                      <img
                        src="/src/assets/icon/pause.png"
                        alt
                        style="width: 12px; height: 20px; margin-right: 2px"
                      />
                      Tạm dừng
                    </div>
                    <div class="displayFlex" style="font-size: 12px">
                      <img
                        src="/src/assets/icon/micOff.png"
                        alt
                        style="width: 12px; height: 20px; margin-right: 2px"
                      />
                      Tắt âm
                    </div>
                    <div class="displayFlex" style="font-size: 12px">
                      <img
                        src="/src/assets/icon/number-pad.png"
                        alt
                        style="width: 12px; height: 20px; margin-right: 2px"
                      />
                      Đầu số
                    </div>
                    <div class="displayFlex" style="font-size: 12px">
                      <img
                        src="/src/assets/icon/book.png"
                        alt
                        style="width: 12px; height: 20px; margin-right: 2px"
                      />
                      Chuyển
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="jss623">
              <span
                class="nodrag speed-internet-in-call-small animate__animated animate__fadeInLeft"
                id="status-watch-in-call-small"
                >Đang trong cuộc gọi...</span
              >
              <span
                class="nodrag speed-internet-in-call-small animate__animated animate__fadeInLeft speedInternet"
                id="speedInternet"
              >
                <div>
                  <div class="col"></div>
                  <div class="col"></div>
                  <div class="col"></div>
                </div>
                <span
                  class="internetSpeedRealtime"
                  id="internetSpeedRealtime"
                ></span>
              </span>
              <div
                class="css-17xyljb css-1fvhrr5 icon-status-count"
                width="20"
                height="20"
                color="error"
              >
                <div>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 172 172"
                    class="injected-svg"
                    data-src="/_next/static/chunks/media/images/ic_outbound.2a76ea82b0313497a58a.svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    role="img"
                    style="height: 100%"
                  >
                    <g
                      fill="none"
                      stroke-miterlimit="10"
                      font-family="none"
                      font-weight="none"
                      font-size="none"
                      text-anchor="none"
                      style="mix-blend-mode: normal"
                    >
                      <path d="M0 172V0h172v172z"></path>
                      <path
                        d="M127.152 14.277a5.376 5.376 0 0 0-3.744 9.232l12.325 12.324H94.958a5.376 5.376 0 1 0 0 10.75h40.775l-12.325 12.325a5.376 5.376 0 1 0 7.6 7.6l21.5-21.5a5.376 5.376 0 0 0 0-7.6l-21.5-21.5a5.376 5.376 0 0 0-3.856-1.63zm-79.148.098c-1.79-.139-3.63.06-5.438.637l-7.712 2.47c-7.65 2.445-13.513 8.994-15.405 17.225-4.497 19.557.899 43.367 16.174 71.428 15.265 28.026 31.992 44.876 50.188 50.552 7.708 2.404 16.044.284 21.878-5.571l5.858-5.886c5.468-5.49 6.262-14.423 1.855-20.898l-8.833-12.976c-3.791-5.568-10.524-7.932-16.706-5.872l-13.423 4.48c-1.792.598-3.802.283-5.25-.931-5.464-4.59-10.1-10.163-13.906-16.706-3.812-6.558-6.272-13.206-7.383-19.946-.29-1.763.382-3.548 1.68-4.78l11.512-10.926c4.88-4.63 6.365-12.074 3.682-18.406l-6.16-14.53c-2.321-5.477-7.243-8.946-12.61-9.364z"
                        fill="#1e3150"
                      ></path>
                    </g>
                  </svg>
                </div>
              </div>
              <span
                class="nodrag count-watch-in-call-small animate__animated animate__fadeInLeft"
                style="font-size: 14px"
                id="count-watch-in-call-small"
                >Đang kết nối...</span
              >
              <button
                class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh btn-accept-call-small"
                tabindex="0"
                type="button"
                onclick="acceptCall()"
                id="btn-accept-call-small"
                style="
                  min-width: unset;
                  background-color: rgb(86, 204, 110);
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
                autocomplete="off"
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_phone_filled.251aab66be05671ffa54.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="m82.116 23.74 6.16 14.53c2.683 6.332 1.196 13.778-3.684 18.408L73.082 67.6c-1.297 1.232-1.97 3.02-1.68 4.783 1.11 6.74 3.572 13.388 7.385 19.945 3.805 6.543 8.438 12.112 13.903 16.702 1.448 1.215 3.458 1.53 5.25.932l13.426-4.48c6.182-2.06 12.911.309 16.702 5.877l8.833 12.975c4.408 6.476 3.616 15.405-1.852 20.895l-5.863 5.884c-5.833 5.855-14.165 7.98-21.872 5.575-18.197-5.676-34.924-22.524-50.189-50.55-15.286-28.064-20.679-51.88-16.182-71.437 1.892-8.23 7.75-14.785 15.401-17.229l7.715-2.465c7.239-2.304 14.96 1.43 18.057 8.733z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
              </button>
            </div>
            <div>
              <button
                class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info btn-pad-number large info hbg-primary css-qkyvyh"
                tabindex="0"
                type="button"
                onclick="endCallTemp()"
                id="btn-end-call-small"
                style="
                  background-color: #dc143c;
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 15px;
                  padding: 0px;
                "
                autocomplete="off"
              >
                <div
                  draggable="false"
                  class="css-17xyljb css-1lrnpvo"
                  width="20"
                  height="20"
                  color="primary"
                >
                  <div>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 172 172"
                      class="injected-svg"
                      data-src="/_next/static/chunks/media/images/ic_end_call_filled.51f030ab462d36de0350.svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink"
                      role="img"
                      style="height: 100%"
                    >
                      <g
                        fill="none"
                        stroke-miterlimit="10"
                        font-family="none"
                        font-weight="none"
                        font-size="none"
                        text-anchor="none"
                        style="mix-blend-mode: normal"
                      >
                        <path d="M0 172V0h172v172z"></path>
                        <path
                          d="M86 17.917c-29.835-.04-49.988 6.278-64.031 18.658-5.909 5.21-8.68 12.922-7.279 20.275l1.414 7.419c1.326 6.952 7.834 11.62 15.201 10.911l14.662-1.414c6.393-.616 11.84-5.149 13.466-11.205l4.451-15.299C70.581 44.517 78.834 43 86 43c7.167 0 14.66 1.332 21.353 4.073l4.458 15.3c1.627 6.055 7.077 10.588 13.466 11.204l14.662 1.414c7.367.71 13.868-3.952 15.194-10.904l1.414-7.419c1.401-7.353-1.363-15.072-7.272-20.282-14.04-12.384-33.44-18.43-63.275-18.47zm-.084 53.673a5.376 5.376 0 0 0-5.291 5.452v58.69l-14.116-14.116a5.376 5.376 0 1 0-7.601 7.601L82.2 152.509a5.376 5.376 0 0 0 7.6 0l23.292-23.292a5.376 5.376 0 1 0-7.6-7.6l-14.117 14.116V77.042a5.375 5.375 0 0 0-5.459-5.452z"
                          fill="#1e3150"
                        ></path>
                      </g>
                    </svg>
                  </div>
                </div>
              </button>
              <button
                class="btn-pad-number large info hbg-primary colorful contained rounded shadow Info css-qkyvyh btn-ended-call"
                tabindex="0"
                type="button"
                onclick="endCall()"
                id="btn-ended-call-small"
                style="
                  width: 75px;
                  background-color: rgb(86, 204, 110);
                  box-shadow: none;
                  line-height: normal;
                  border-radius: 12px;
                  text-transform: none;
                  letter-spacing: normal;
                  font-size: 14px;
                  padding: 0px;
                "
                autocomplete="off"
              >
                <div>
                  <span> Đóng </span>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script type="module" src="/src/main.jsx"></script>
    <script type="module" src="/src/modal_ticket.jsx"></script>
    <script type="module" src="/src/Click2call.jsx"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
      integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      AOS.init();
    </script>
    <script>
      var hours = 8;
      var now = new Date().getTime();
      var setupTime = localStorage.getItem("setTimeToken");
      if (setupTime == null) {
        localStorage.setItem("setTimeToken", now);
      } else {
        if (now * 1 - setupTime * 1 > hours * 60 * 60 * 1000) {
          localStorage.clear();
        }
      }

      let token = localStorage.getItem("token");

      let urlWeb = location.href;
      ////console.log(urlWeb);
      let xy = urlWeb.search("login");
      ////console.log("check", xy);

      function checkCallCenter(x) {
        xy = x;
        if (xy > 0) {
          //không cho hiên và không kết nối đến Call
          $(".phone-pad").hide();
        } else {
          //cho phép
          token = localStorage.getItem("token");

          loadCall();
          setTimeout(function () {
            $(".phone-pad").show();
          }, 3000);
        }
      }
      if (xy > 0) {
        $(".phone-pad").hide();
      } else {
        setTimeout(function () {
          $(".phone-pad").show();
        }, 3000);
      }

      async function checkphonepad() {
        let local = await localStorage.getItem("settingCall");
        let check = urlWeb.search("system");
        if (check > 0) {
          if (local != 1) {
            $(".phone-pad").addClass("dd-none");
          } else {
            loadCall();
            Notiflix.Notify.success("Đang kết nối đến tổng đài");
            setTimeout(function () {
              Notiflix.Notify.success("kết nối thành công");
              $(".phone-pad").removeClass("dd-none");
            }, 3000);
          }
        } else {
          $(".phone-pad").addClass("dd-none");
        }
      }

      $(document).ready(function () {
        checkphonepad();

        setInterval(function () {
          //$(".date-now").html(moment().format("DD/MM/YYYY"));
          $(".time-now")
            .html
            // moment().format("HH:mm:ss") + " " + moment().format("A")
            ();
        }, 1000);
        // /*create  canvas has id = clock / and insrt div jss387*/

        let canvas = document.createElement("canvas");
        canvas.id = "clock";
        canvas.width = 150;
        canvas.height = 150;
        canvas.style.zIndex = 9999;
        // canvas.style.position = "absolute";
        // canvas.style.border = "1px solid";
        $(".custom-watch").html(canvas);

        let context = canvas.getContext("2d");
        let radius = canvas.height / 2;

        function drawClock() {
          context.beginPath();
          context.arc(radius, radius, radius - 5, 0, 2 * Math.PI);
          context.fillStyle = "white";
          context.fill();
          context.strokeStyle = "black";
          context.lineWidth = 1;
          context.stroke();
          context.beginPath();
          context.arc(radius, radius, 5, 0, 2 * Math.PI);
          context.fillStyle = "black";
          context.fill();
          //Hiển thị các số trên đồng hồ
          for (let i = 1; i <= 12; i++) {
            context.font = radius * 0.2 + "px arial";
            context.textBaseline = "middle";
            context.textAlign = "center";
            let x = radius + (radius - 20) * Math.sin((i * Math.PI) / 6);
            let y = radius - (radius - 20) * Math.cos((i * Math.PI) / 6);
            context.fillText(i, x, y);
          }
        }

        // Vẽ kim giờ
        function drawHour(hour, minute) {
          var hourAngle =
            ((hour % 12) * Math.PI) / 6 + (minute * Math.PI) / 360;
          var hourLength = radius * 0.5;
          var hourX = radius + hourLength * Math.sin(hourAngle);
          var hourY = radius - hourLength * Math.cos(hourAngle);
          context.lineWidth = 5;
          context.beginPath();
          context.moveTo(radius, radius);
          context.lineTo(hourX, hourY);
          context.stroke();
        }

        // Vẽ kim phút
        function drawMinute(minute) {
          var minuteAngle = (minute * Math.PI) / 30;
          var minuteLength = radius * 0.7;
          var minuteX = radius + minuteLength * Math.sin(minuteAngle);
          var minuteY = radius - minuteLength * Math.cos(minuteAngle);
          context.lineWidth = 3;
          context.beginPath();
          context.moveTo(radius, radius);
          context.lineTo(minuteX, minuteY);
          context.stroke();
        }

        // Vẽ kim giây
        function drawSecond(second) {
          var secondAngle = (second * Math.PI) / 30;
          var secondLength = radius * 0.8;
          var secondX = radius + secondLength * Math.sin(secondAngle);
          var secondY = radius - secondLength * Math.cos(secondAngle);
          context.lineWidth = 1;
          context.beginPath();
          context.moveTo(radius, radius);
          context.lineTo(secondX, secondY);
          context.stroke();
        }

        // Cập nhật thời gian và vị trí của các kim đồng hồ

        function updateClock() {
          var now = new Date();
          var hour = now.getHours();
          var minute = now.getMinutes();
          var second = now.getSeconds();
          drawClock();
          drawHour(hour, minute);
          drawMinute(minute);
          drawSecond(second);
        }
        /* Create watch */
        setInterval(function () {
          updateClock();
        }, 1000);

        //creat calendar by datepicker
        // $('.custom-calendar').datepicker({
        //     format: 'dd/mm/yyyy',
        //     todayHighlight: true,
        //     autoclose: true,
        //     language: 'vi',
        //     todayBtn: true,
        //     todayHighlight: true,
        // });
        // // $('.date-picker').datepicker('setDate', new Date());
        // $('.date-picker').datepicker('setDate', moment().format('DD/MM/YYYY'));
        // $('.date-picker').datepicker('setDate', 'today');
        // $('.date-picker').datepicker('setDate', 'now');
      });

      // Cập nhật thời gian mỗi giây

      /* Setting */
      function settings() {
        if ($(".multi-settings").hasClass("active")) {
          $(".multi-settings").removeClass("active");
        } else {
          $(".multi-settings").addClass("active");
        }
        if ($(".call-settings").hasClass("active")) {
          $(".call-settings").removeClass("active");
        } else {
          $(".call-settings").addClass("active");
        }
      }

      /* Change status extension */
      function updateStatusExtensionLoading(id) {
        // //console.log('updateStatusExtensionLoading', id);
        //  #top_status-options-flat > a  has data-id = id , add class active
        $("#top_status-options-flat > a")
          .removeClass("active")
          .removeClass("active-status");
        $('#top_status-options-flat > a[data-id="' + id + '"]')
          .addClass("active")
          .addClass("active-status");
        // get data-status , data-color ,   callChangeStatus
        let status = $(
          '#top_status-options-flat > a[data-id="' + id + '"]'
        ).attr("data-status");
        let color =
          "#" +
          $('#top_status-options-flat > a[data-id="' + id + '"]').attr(
            "data-color"
          );
        callChangeStatus(status, color);
      }

      function btnChangeStatusExtension() {
        // id modal-call display none -> display block
        if ($("#modal-call").css("display") == "none") {
          btnOnModalCall();
        }

        var has = $(".btn-change-status-extension").hasClass("active");
        if (has) {
          $(".btn-change-status-extension").removeClass("active");
        } else {
          $(".btn-change-status-extension").addClass("active");
        }
        $("#modal-change-status-extension").toggle();
      }

      //  > a click , remove active all a , add active to a click set background color for a click , call function change status
      $("#top_status-options-flat > a").click(function () {
        $("#top_status-options-flat > a")
          .removeClass("active")
          .removeClass("active-status");

        $(this).addClass("active").addClass("active-status");
        let status = $(this).attr("data-status");
        //set color button change status
        let color = "#" + $(this).attr("data-color");
        // chage color .css-1lrnpvo path:not([fill*="url"])[fill*="#"], [data-css-1lrnpvo] path:not([fill*="url"])[fill*="#"] {
        //     fill: #008c88;
        // }

        callChangeStatus(status, color);
        btnChangeStatusExtension();
      });

      function callChangeStatus(status, color) {
        changeStatusExtension(status);
        $(
          '.btn-change-status-extension .css-1lrnpvo path:not([fill*="url"])[fill*="#"], [data-css-1lrnpvo] path:not([fill*="url"])[fill*="#"]'
        ).css("fill", color);
        $(".csdPhoneClient").css("background-color", color);
      }
      async function changeStatusExtension(status) {
        await $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/changeStatusExtension",
          type: "POST",
          headers: {
            Authorization: "Bearer " + token,
          },
          data: {
            status: status,
          },
          success: function (data) {
            // //Notiflix.Notify.success(data.message);
          },
        });
      }
      async function checkStatusWhenBtnChangeStatusExtension() {
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/checkInfo",
          headers: {
            Authorization: "Bearer " + token,
          },
          type: "GET",
          success: function (data) {
            $("#top_status-options-flat > a")
              .removeClass("active")
              .removeClass("active-status");
            $(
              '#top_status-options-flat > a[data-id="' +
                data.data.status_ext +
                '"]'
            )
              .addClass("active")
              .addClass("active-status");
            let status = $(
              '#top_status-options-flat > a[data-id="' +
                data.data.status_ext +
                '"]'
            ).attr("data-status");
            let color =
              "#" +
              $(
                '#top_status-options-flat > a[data-id="' +
                  data.data.status_ext +
                  '"]'
              ).attr("data-color");
            callChangeStatus(status, color);
          },
        });
      }

      function checkStatusExt() {
        // get data-status from #top_status-options-flat > a with class active
        status = $("#top_status-options-flat > a.active").attr("data-status");
        return status;
      }
      /* Create tooltip for button */
      // $('.btn-change-status-extension').tooltip({
      //     title: 'Change status',
      //     placement: 'top'
      // });

      /* Hover create tooltip for button */

      /* Removing the class "show" from the divs with the classes "jss615" and "jss610" when the user clicks outside of the divs. */
      let CheckFrom;
      $(document).mouseup(function (e) {
        var jss615 = $(".jss615");
        var jss372 = $(".jss372");
        if (
          !jss615.is(e.target) &&
          jss615.has(e.target).length === 0 &&
          $(".jss615").hasClass("show") &&
          !jss372.is(e.target) &&
          jss372.has(e.target).length === 0
        ) {
          $(".jss615").removeClass("show");
        }
        var jss610 = $(".jss610");
        var jss388 = $(".jss388");
        if (
          !jss610.is(e.target) &&
          jss610.has(e.target).length === 0 &&
          $(".jss610").hasClass("show") &&
          !jss388.is(e.target) &&
          jss388.has(e.target).length === 0
        ) {
          $(".jss610").removeClass("show");
        }
      });
      /* The above code is a jQuery function that is executed when the document is ready. */
      $(document).ready(function () {
        // Vẽ mặt đồng hồ

        /* Creating a custom event called displaychange. */
        $.event.special.displaychange = {
          setup: function () {
            var el = $(this);
            el.data("olddisplay", el.css("display"));
            el.data(
              "checkdisplay",
              setInterval(function () {
                if (el.css("display") !== el.data("olddisplay")) {
                  el.data("olddisplay", el.css("display"));
                  el.trigger("displaychange");
                }
              }, 250)
            );
          },
          teardown: function () {
            clearInterval($(this).data("checkdisplay"));
          },
        };

        /* Checking to see if the display is set to block. If it is, it will disable the
          csdPhoneClient class. If it is not, it will enable the csdPhoneClient class. */
        $(".info-call").on("displaychange", function () {
          var display = $(this).css("display");
          if (display == "block") {
            $(".csdPhoneClient").attr("disabled", true);
          } else {
            $(".csdPhoneClient").attr("disabled", false);
          }
        });

        /* *|MARCADOR_CURSOR|* */
        $(".search-number-call").keyup(function () {
          var search = $(this).val();
          $.ajax({
            url: "https://apicallcenter.smartvcc.vn/api/callcenter/search-phone",
            headers: {
              Authorization: "Bearer " + token,
            },
            type: "GET",
            data: {
              _token: "{{ csrf_token() }}",
              phone: search,
            },
            success: function (data) {
              var option_phone = "";
              data.data.forEach(function (item) {
                if (item.in_call == 1) {
                  option_phone += '<div class="jss81" style="height: unset;">';
                  option_phone +=
                    '<div   data-label ="' +
                    item.name_group +
                    '" data-key ="' +
                    item.key +
                    '"  data-id ="' +
                    item.id +
                    '"  data-number="' +
                    item.phone +
                    '" class="jss616 active">';
                  option_phone += "<div>" + item.phone + "</div>";
                  option_phone +=
                    "<div><span>" +
                    item.name_group +
                    '</span><span style="display: none;"> ' +
                    item.phone +
                    "</span></div>";
                  option_phone += "</div>";
                  option_phone += "</div>";
                } else {
                  option_phone += '<div class="jss81" style="height: unset;">';
                  option_phone +=
                    '<div   data-label ="' +
                    item.name_group +
                    '" data-key ="' +
                    item.key +
                    '"  data-id ="' +
                    item.id +
                    '"  data-number="' +
                    item.phone +
                    '" class="jss616">';
                  option_phone += "<div>" + item.phone + "</div>";
                  option_phone +=
                    "<div><span>" +
                    item.name_group +
                    '</span><span style="display: none;"> ' +
                    item.phone +
                    "</span></div>";
                  option_phone += "</div>";
                  option_phone += "</div>";
                }
              });
              $(".option-phone").html(option_phone);
              $(".jss81").hover(
                function () {
                  $(this).attr("style", "background-color: #f5f5f5 !important");
                },
                function () {
                  $(this).attr("style", "background-color: #fff !important");
                }
              );
              $(".jss81").click(function () {
                $(".search-number-call").val("");
                $(".jss616").removeClass("active");
                $(this).find(".jss616").addClass("active");
                $(this).parent().prepend($(this));
                $(".phone-incall").html(
                  $(this).find(".jss616").attr("data-number")
                );
                $(".phone-incall").attr(
                  "data-phone",
                  $(this).find(".jss616").attr("data-number")
                );
                $(".phone-incall").attr(
                  "data-key",
                  $(this).find(".jss616").attr("data-key")
                );
                $(".phone-incall").attr(
                  "data-label",
                  $(this).find(".jss616").attr("data-label")
                );
                $(".jss615").removeClass("show");
                // update active phone on db
                updateActivePhoneDB($(this).find(".jss616").attr("data-id"));
              });
            },
          });
        });

        /* A search function for the customer's phone number. */
        $(".input-search-info-customer").keyup(function () {
          var search = $(this).val();
          if (search == "") {
            // <div class="jss87 active"><span>Không áp dụng</span></div>
            var htmlNoUser =
              `<div class="jss78 search-info-customer" onclick="noUseFastCallAndCickFastCall(this)"` +
              `data-phone=""` +
              `onmouseover="onmouseoverNoUserFastCall(this)" onmouseout="onmouseoutNoUserFastCall(this)">
                      <div class="jss87 active ">
                          <div class="css-17xyljb " width="20" height="20">
                              <div>
                                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172"
                                      class="injected-svg"
                                      data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                                      xmlns:xlink="http://www.w3.org/1999/xlink" role="img"
                                      style="height:100%">
                                      <g fill="none" stroke-miterlimit="10" font-family="none"
                                          font-weight="none" font-size="none" text-anchor="none"
                                          style="mix-blend-mode:normal">
                                          <path d="M0 172V0h172v172z"></path>
                                          <path
                                              d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                                              fill="#1e3150"></path>
                                      </g>
                                  </svg>
                              </div>
                          </div>
                          <span>Không áp dụng</span>
                      </div></div>`;
            $(".search-info-customer").empty().html(htmlNoUser);
          } else {
            $.ajax({
              url: "https://apicallcenter.smartvcc.vn/api/callcenter/search-customer",
              headers: {
                Authorization: "Bearer " + token,
              },
              type: "GET",
              data: {
                _token: "{{ csrf_token() }}",
                search: search,
              },
              success: function (data) {
                var htmlNoUser = "";
                if (data.data.length > 0) {
                  data.data.forEach(function (item) {
                    htmlNoUser +=
                      `<div class="jss78 search-info-customer" onclick="noUseFastCallAndCickFastCall(this)"` +
                      `data-phone="` +
                      item.phone +
                      `"` +
                      ` onmouseover="onmouseoverNoUserFastCall(this)" onmouseout="onmouseoutNoUserFastCall(this)">
                                  <div class="jss87 active">
                                      <div class="css-17xyljb " width="20" height="20">
                                          <div>
                                              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172"
                                                  class="injected-svg"
                                                  data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                                                  xmlns:xlink="http://www.w3.org/1999/xlink" role="img"
                                                  style="height:100%">
                                                  <g fill="none" stroke-miterlimit="10" font-family="none"
                                                      font-weight="none" font-size="none" text-anchor="none"
                                                      style="mix-blend-mode:normal">
                                                      <path d="M0 172V0h172v172z"></path>
                                                      <path
                                                          d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                                                          fill="#1e3150"></path>
                                                  </g>
                                              </svg>
                                          </div>
                                      </div>
                                      <span>` +
                      item.phone +
                      ` - ` +
                      item.name +
                      `</span>
                                  </div></div>`;
                  });
                } else {
                  htmlNoUser =
                    `<div class="jss78 search-info-customer" onclick="noUseFastCallAndCickFastCall(this)"` +
                    `data-phone="` +
                    `"` +
                    `onmouseover="onmouseoverNoUserFastCall(this)" onmouseout="onmouseoutNoUserFastCall(this)"><div class="jss87 active ">
                                      <div class="css-17xyljb " width="20" height="20">
                                          <div>
                                              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172"
                                                  class="injected-svg"
                                                  data-src="/_next/static/chunks/media/images/ic_audio_1.a46a9df578fea64b5d37.svg"
                                                  xmlns:xlink="http://www.w3.org/1999/xlink" role="img"
                                                  style="height:100%">
                                                  <g fill="none" stroke-miterlimit="10" font-family="none"
                                                      font-weight="none" font-size="none" text-anchor="none"
                                                      style="mix-blend-mode:normal">
                                                      <path d="M0 172V0h172v172z"></path>
                                                      <path
                                                          d="M86 14.333c-19.759 0-35.833 16.075-35.833 35.834C50.167 69.925 66.242 86 86 86c19.759 0 35.833-16.075 35.833-35.833 0-19.759-16.075-35.834-35.833-35.834zm61.96 68.084c-1.2.012-2.406.177-3.584.49-11.8 3.124-22.79 12.927-32.67 29.15-9.893 16.242-13.355 30.194-10.288 41.452 1.218 4.465 4.867 8.063 9.525 9.393l5.46 1.553c4.468 1.28 9.294-.8 11.211-4.843l4.213-8.895c1.642-3.458.783-7.516-2.141-10.1l-6.992-6.179a4.379 4.379 0 0 1-1.47-2.758c-.114-.985-.464-3.99 4.41-11.995 2.271-3.73 4.412-6.453 6.361-8.09.807-.674 2.935-2.47 5.39-1.778l9.399 2.722c3.827 1.11 7.962-.215 10.302-3.29l5.99-7.866c2.728-3.583 2.232-8.572-1.147-11.61l-4.15-3.717c-2.666-2.392-6.22-3.677-9.82-3.64zM44.791 100.333c-8.89 0-16.125 7.235-16.125 16.125v2.737c0 8.435 3.51 16.54 9.63 22.242 7.955 7.403 22.688 16.23 47.703 16.23a97.13 97.13 0 0 0 9.147-.427c-.233-.606-.472-1.22-.644-1.855-3.612-13.23.118-29.064 11.08-47.06 1.744-2.866 3.547-5.487 5.374-7.992z"
                                                          fill="#1e3150"></path>
                                                  </g>
                                              </svg>
                                          </div>
                                      </div>
                                      <span>Không tồn tại số điện thoại này</span>
                                  </div></div>`;
                }
                $(".search-info-customer").empty().html(htmlNoUser);
              },
            });
          }
        });

        /* Changing the background color of the element with the class jss374 when the element with
          the class jss372 is hovered over. */
        $(".jss372").hover(
          function () {
            $(".jss374").attr("style", "background-color: #f5f5f5 !important");
          },
          function () {
            $(".jss374").attr("style", "background-color: #fff !important");
          }
        );

        /* Removing the class show from the element with the class jss610 and then checking if the
          element with the class jss615 has the class show. If it does, it removes the class show
          from the element with the class jss615. If it does not, it adds the class show to the
          element with the class jss615. */
        $(".jss372").click(function () {
          $(".jss610").removeClass("show");
          var show = $(".jss615").hasClass("show");
          if (show) {
            $(".jss615").removeClass("show");
          } else {
            $(".jss615").addClass("show");
          }
        });

        /* Changing the background color of the button when the mouse is hovered over it. */
        $(".modal-search-phone").hover(
          function () {
            $(this).attr("style", "background-color: #2d50b2; opacity: 1");
          },
          function () {
            $(this).attr("style", "background-color: #2d50b2;");
            var show = $(".jss610").hasClass("show");
            if (show) {
              $(this).attr(
                "style",
                "background-color: #2d50b2!important; opacity: 1!important"
              );
            }
          }
        );
        /* Adding a class to the element with the class of jss610. */
        $(".modal-search-phone").click(function () {
          $(".jss615").removeClass("show");
          var show = $(".jss610").hasClass("show");
          if (show) {
            $(".jss610").removeClass("show");
            $(this).attr(
              "style",
              "background-color: #006676!important; opacity: 0.5!important"
            );
          } else {
            $(".jss610").addClass("show");
            $(this).attr(
              "style",
              "background-color: #2d50b2!important; opacity: 1!important"
            );
          }
        });
      });

      /**
       * It changes the background color of the element that is passed to it to a light gray
       */
      function onmouseoverNoUserFastCall(x) {
        $(x).attr(
          "style",
          "background-color: rgba(14, 171, 175, .12) !important;cursor: pointer;"
        );
      }
      /**
       * It changes the background color of the element that was moused over to white.
       */

      function onmouseoutNoUserFastCall(x) {
        $(x).attr("style", "background-color: #fff !important");
      }

      /**
       * A function that is called when the user clicks on the phone number in the customer list.
       */
      function noUseFastCallAndCickFastCall(card) {
        getSpeedInternet();

        checkStatusWhenBtnChangeStatusExtension();
        checkStatus = checkStatusExt();
        if (checkStatus != 1) {
          ////Notiflix.Notify.info("Ip phone chưa online, vui lòng kiểm tra lại");
          btnChangeStatusExtension();
          return;
        }
        $(".modal-search-phone").click();
        var phone = card.getAttribute("data-phone");
        if (phone.length > 0) {
          var userId = card.getAttribute("data-user-id");
          var keyPhone = $(".phone-incall").attr("data-key");
          btnOffModalCall();
          $(".info-call").show();
          getInfoCustomer(phone);
          setTimeStartCall();
          uiWhenCallOutgoing();
          getInfoNumberCall();
          // Số key + phone để gọi
          var phoneEnd = "";
          if (keyPhone == 1) {
            phoneEnd = phone;
          } else {
            phoneEnd = keyPhone + phone;
          }
          ctxSip.sipCall(phoneEnd);
          callingOut = "has";
        }
      }

      /**
       * A function that is called when the user clicks on the "Call" button.
       */

      /**
       * It takes the value of the button that was clicked and adds it to the value of the input
       * field
       */

      // id number-phone , when change value if value is number show clear-number-phone
      // else hide clear-number-phone
      var phoneInputTemp = "";
      $("#number-phone").on("input", function () {
        var value = $(this).val();
        ////console.log("🚀 ~ file: modal_call.blade.php:994 ~ $ ~ value:", value);
        if (value.length > 0) {
          $(".clear-number-phone").show();
        } else {
          $(".history-called").addClass("active");
          $(".recommend-call").removeClass("active");
          $(".clear-number-phone").hide();
        }
        //check value have special character < > !@@#!@$%^&*()_+{}|:"<>?[]\;',./
        var regex = /[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/;
        if (regex.test(value)) {
          $(this).val(
            value.replace(/[`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/g, "")
          );
          var value = $(this).val();
          if (value == "") {
            $(".clear-number-phone").click();
            $(".clear-number-phone").hide();
          } else {
            $(".clear-number-phone").show();
          }
        }
        //check value have space character
        if (value.indexOf(" ") >= 0) {
          $(this).val(value.replace(/\s/g, ""));
          var value = $(this).val();
          if (value == "") {
            $(".clear-number-phone").click();
            $(".clear-number-phone").hide();
          } else {
            $(".clear-number-phone").show();
          }
        }
        // check value have character
        if (isNaN(value)) {
          $(this).val(value.replace(/[a-zA-Z]/g, ""));
          var value = $(this).val();
          if (value == "") {
            $(".clear-number-phone").click();
            $(".clear-number-phone").hide();
          } else {
            $(".clear-number-phone").show();
          }
        }
        // check value have unicode character
        if (value.match(/[\u00C0-\u00FF]/g)) {
          $(this).val(value.replace(/[\u00C0-\u00FF]/g, ""));
          var value = $(this).val();
          if (value == "") {
            $(".clear-number-phone").click();
            $(".clear-number-phone").hide();
          } else {
            $(".clear-number-phone").show();
          }
        }
        //check value have vietnamese character ư ơ ô
        if (value.match(/[ươô]/g)) {
          $(this).val(value.replace(/[ươô]/g, ""));
          var value = $(this).val();
          if (value == "") {
            $(".clear-number-phone").click();
            $(".clear-number-phone").hide();
          } else {
            $(".clear-number-phone").show();
          }
        }

        var value = $(this).val();
        if (value != phoneInputTemp && value.length > 0) {
          phoneInputTemp = value;
          $(".history-called").removeClass("active");
          $(".recommend-call").addClass("active");
          recommendCall(value);
        }
        if (value != phoneInputTemp && value.length == 0) {
          $(".history-called").addClass("active");
          $(".recommend-call").removeClass("active");
        }
      });

      function recommendCall(numberPhone) {
        $(".list-recommed-call").empty();
        ////Notiflix.Block.pulse(".list-recommed-call");

        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/recommendCall",
          headers: {
            Authorization: "Bearer " + token,
          },
          type: "GET",
          data: {
            phone: numberPhone,
          },

          success: function (data) {
            var path =
              window.location.protocol + "//" + window.location.hostname;
            var html = "";
            if (data.data.length == 0) {
              //không có kết quả // center
              html +=
                '<div class="item w- justify-content-center" style="background-color: #fff !important">';
              html +=
                '<span class="text-center"><i>Không có kết quả</i></span>';
              html += "</div>";
            } else {
              data.data.forEach(function (item) {
                var name = "Không xác định";

                if (item.name != null) {
                  name = item.name;
                }
                if (item.gender == 1) {
                  src = "/src/assets/image/man.png";
                } else {
                  src = "/src/assets/image/woman.png";
                }

                html += `<div class="item w-100 " data-phone="${item.phone}" style="background-color: #fff !important">`;
                html += '<div class="info">';
                html +=
                  '<div class="jss82" style="width: 32px; min-width: 32px; height: 32px; min-height: 32px; background-color: rgba(232, 42, 143, 0.3); opacity: 1;">';
                html +=
                  '<div style="position: absolute; bottom: -5px; display: flex; justify-content: center; width: 100%;">';
                html += `<img alt="" draggable="false" class="css-1rtqv6b" width="70%" height="70%" src="${src}" id="img-customer-calling-bigg">`;
                html += "</div>";
                html += "</div>";
                html += `<div class="content"><b>${name}</b>`;
                html += `<span>${item.phone}</span>`;
                html += "</div>";
                html += "</div>";
                html += "</div>";
              });
            }
            setTimeout(function () {
              $(".list-recommed-call").html(html);
            }, 1000);
          },
        });
      }

      function addNumber(input) {
        ctxSip.dtmfTone.play();
        var value = $(input).val();
        var phone = $("#number-phone").val();
        $("#number-phone").val(phone + value);
        $(".clear-number-phone").show();
      }
      $(".clear-number-phone").click(function () {
        $("#number-phone").val("");
        $(".clear-number-phone").hide();
      });

      function btnOnModalCall() {
        $("#modal-call").show();
        $("#session-btn-right").hide();
        getHistoryCall();
      }

      /**
       * It removes the class active from the on-off-pad and hides the modal-call and shows the
       * session-btn-right.
       */
      function btnOffModalCall() {
        $("#modal-call").hide();
        $("#session-btn-right").show();
        $("#modal-pad-number").hide();
      }

      /**
       * It toggles the modal-pad-number div.
       */
      function btnOnOffModalPadNumber() {
        var has = $(".on-off-pad").hasClass("active");
        if (has) {
          $(".on-off-pad").removeClass("active");
        } else {
          $(".on-off-pad").addClass("active");
        }
        $("#modal-pad-number").toggle();
      }

      /**
       * It hides the info-call div, and then sets the screen-small div to display flex, and then
       * sets the minHeight and minWidth variables to the window's inner height and width, and then
       * sets the screen-small div's transform property to translate the div by the minWidth divided
       * by 6 and the minHeight divided by 12
       */
      function collapseModalInfoCall() {
        $(".info-call").hide();
        $(".screen-small").attr(
          "style",
          "display: flex !important; z-index:10000000"
        );
        var minHeight = window.innerHeight;
        var minWidth = window.innerWidth;
        // $('.screen-small').css('transform', 'translate(' + minWidth / 6 + 'px, -' + minHeight / 12 + 'px)');
      }

      /**
       * The function enlarges the modal window and hides the small screen
       */
      function enlargeModalInfoCall() {
        $(".info-call").show();
        $(".screen-small").hide();
      }

      function handleClickMonitor(data) {
        $.ajax({
          url: data.link,
          headers: {},
          data: data.body,
          method: "post",
          success: async function (res) {
            console.log(".notiflix-" + data?.body?.dst);
            Notiflix.Block.remove(".notiflix-" + data?.body?.dst);
          },
        });
      }

      function csClickToCall(call, userPhone) {
        console.log(call, userPhone);
        // ajax url callcenter/click-to-call
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/click-to-call",
          headers: {
            Authorization: "Bearer " + token,
          },
          data: {
            from_number: userPhone,
            to_number: call,
          },
          method: "POST",
          success: async function (data) {
            console.log(data);
            let check = true;
            const myTimeout = setTimeout(() => {
              console.log("timeout");
              Notiflix.Notify.success("Thao tác thành công");
            }, 3000);
            await $.get(data.data.link_portal, function (data) {
              clearTimeout(myTimeout);
              if (data != "Success") {
                Notiflix.Notify.failure("Thao tác thất bại");
                check = false;
              }
            });
            clearTimeout(myTimeout);
            if (check) {
              Notiflix.Notify.success("Thao tác thành công");
            }
          },
        });
      }

      /*  */
      function csInterFacePhoneClient(userId, phone) {
        checkStatusWhenBtnChangeStatusExtension();
        checkStatus = checkStatusExt();
        if (checkStatus != 1) {
          //Notiflix.Notify.info("Ip phone chưa online, vui lòng kiểm tra lại");
          btnChangeStatusExtension();
          return;
        }

        resetWatchInCall();
        var keyPhone = $(".phone-incall").attr("data-key");
        if (phone == "") {
          //toastr.error("Chưa có điện thoại");
          return;
        }
        btnOffModalCall();
        $(".info-call").show();
        getInfoCustomer(phone);
        setTimeStartCall();
        uiWhenCallOutgoing();
        getInfoNumberCall();
        var phoneEnd = "";
        if (keyPhone == 1) {
          phoneEnd = phone;
        } else {
          phoneEnd = keyPhone + phone;
        }
        getSpeedInternet();
        ctxSip.sipCall(phoneEnd);
        callingOut = "has";
        $("#session-btn-right").hide();
      }

      /**
       * A function that is called when a call is received.
       */
      function csdIncomingPhoneClient(newSess) {
        let checkClickToCall = localStorage.getItem("settingCallClickToCall");
        if (checkClickToCall != 1) {
          addAnimationButtonIncomingCall();
          btnOffModalCall();
          // setTimeStartCall();
          getInfoCustomer(newSess.displayName);
          $("#comment").attr("data-callid", newSess.id);
          $(".info-call").show();
          $("#session-btn-right").hide();
          $(".speedInternet").hide();
        }
      }
      /**
       Lịch sử gọi cuộc của user login
      */

      function getHistoryCall() {
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/history-called",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "GET",
          success: function (data) {
            var call = "";
            if (data.data.length == 0) {
              call += `<span class="jss392 jss381">Chưa có dữ liệu</span>`;
              $(".list-history-call").empty().html(call);
            }
            data.data.forEach(function (item) {
              var name = "Không xác định";
              if (item.customer) {
                name = item.customer.name;
              }
              var svg = "";
              if (item.status == "ANSWER") {
                svg += `
                          <div class="css-17xyljb css-1fvhrr6" width="20" height="20" color="error"><div>
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172" class="injected-svg"
                                  data-src="/_next/static/chunks/media/images/ic_outbound.2a76ea82b0313497a58a.svg"
                                  xmlns:xlink="http://www.w3.org/1999/xlink" role="img" style="height:100%">
                                  <g fill="none" stroke-miterlimit="10" font-family="none" font-weight="none"
                                      font-size="none" text-anchor="none" style="mix-blend-mode:normal">
                                      <path d="M0 172V0h172v172z"></path>
                                      <path
                                          d="M127.152 14.277a5.376 5.376 0 0 0-3.744 9.232l12.325 12.324H94.958a5.376 5.376 0 1 0 0 10.75h40.775l-12.325 12.325a5.376 5.376 0 1 0 7.6 7.6l21.5-21.5a5.376 5.376 0 0 0 0-7.6l-21.5-21.5a5.376 5.376 0 0 0-3.856-1.63zm-79.148.098c-1.79-.139-3.63.06-5.438.637l-7.712 2.47c-7.65 2.445-13.513 8.994-15.405 17.225-4.497 19.557.899 43.367 16.174 71.428 15.265 28.026 31.992 44.876 50.188 50.552 7.708 2.404 16.044.284 21.878-5.571l5.858-5.886c5.468-5.49 6.262-14.423 1.855-20.898l-8.833-12.976c-3.791-5.568-10.524-7.932-16.706-5.872l-13.423 4.48c-1.792.598-3.802.283-5.25-.931-5.464-4.59-10.1-10.163-13.906-16.706-3.812-6.558-6.272-13.206-7.383-19.946-.29-1.763.382-3.548 1.68-4.78l11.512-10.926c4.88-4.63 6.365-12.074 3.682-18.406l-6.16-14.53c-2.321-5.477-7.243-8.946-12.61-9.364z"
                                          fill="#1e3150"></path>
                                  </g>
                              </svg>
                          `;
              } else {
                svg = `<div class="css-17xyljb css-1fvhrr5" width="20" height="20" color="error"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 172 172" class="injected-svg"
                                  data-src="/_next/static/chunks/media/images/ic_inbound_missed.43703a336d635872c273.svg"
                                  xmlns:xlink="http://www.w3.org/1999/xlink" role="img" style="height:100%">
                                  <g fill="none" stroke-miterlimit="10" font-family="none" font-weight="none"
                                      font-size="none" text-anchor="none" style="mix-blend-mode:normal">
                                      <path d="M0 172V0h172v172z"></path>
                                      <path
                                          d="M130.806 21.444a5.374 5.374 0 0 0-.7.056h-20.814a5.376 5.376 0 1 0 0 10.75h8.111L85.881 62.435 52.084 30.157a5.376 5.376 0 1 0-7.418 7.769l37.513 35.833a5.376 5.376 0 0 0 7.425 0l35.813-34.293v8.909a5.376 5.376 0 1 0 10.75 0V27.603a5.376 5.376 0 0 0-5.361-6.159zM86 89.584c-34.074 0-53.021 9.852-62.918 18.119-6.848 5.726-9.976 14.901-8.238 23.67.04.1 1.834 6.704 1.834 6.704 1.924 7.307 8.797 12.409 16.713 12.409.856 0 1.72-.06 2.568-.182l16.174-2.303c5.404-.77 9.803-4.7 10.946-9.777l3.192-14.137c.433-1.92 1.897-3.452 3.821-4.003 2.938-.835 8.078-1.834 15.908-1.834s12.966.999 15.901 1.834c1.924.548 3.395 2.079 3.828 4.003l3.185 14.137c1.146 5.078 5.542 9.007 10.946 9.777l16.18 2.303c.85.122 1.716.182 2.57.182 7.918 0 14.791-5.099 16.712-12.409 0 0 1.777-6.56 1.813-6.634 1.774-8.79-1.358-18-8.224-23.74-9.89-8.267-28.837-18.12-62.911-18.12z"
                                          fill="#1e3150"></path>
                                  </g>
                              </svg>`;
              }
              call +=
                ` <div class="item w-100" data-phone="` + item.phone + `">`;
              call += `<div class="info">`;
              call += `   <div class="jss82"
                              style="width: 32px; min-width: 32px; height: 32px; min-height: 32px; background-color: rgba(232, 42, 143, 0.3); opacity: 1;">`;
              call += `    <div style="display: flex; justify-content: center; width: 100%;">`;
              call += `    <img alt="" draggable="false" class="css-1rtqv6b" width="100%"
                                      height="100%" src="/src/assets/image/avatar_default.png"
                                      id="img-customer-calling-bigg">`;
              call += `   </div>`;
              call += `  </div>`;
              call +=
                ` <div class="content"><b>` +
                name +
                `</b>
                              <span>` +
                item.phone +
                `</span></div>`;
              call += ` </div>`;
              call += svg;
              call += `</div>`;
              call += ` </div>`;
              call += ` </div>`;
            });
            $(".list-history-call").empty().html(call);
            /* Changing the background color of the element with the class jss374 when the element with
                  the class item w-100 is hovered over. */
            $(".item.w-100").hover(
              function () {
                $(this).attr(
                  "style",
                  "background-color: #f5f5f5 !important; cursor: pointer"
                );
              },
              function () {
                $(this).attr("style", "background-color: #fff !important");
              }
            );
            $(".item.w-100").click(function () {
              var phone = $(this).attr("data-phone");
              var user = 1;
              csInterFacePhoneClient(user, phone);
            });
          },
        });
      }
      /**
       * Get info customer by phone
       */
      function getInfoCustomer(phone) {
        //Call api get info
        path = window.location.protocol + "//" + window.location.hostname;
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/show-by-phone",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "GET",
          data: {
            phone: phone,
          },
          success: function (data) {
            var src = "";
            name = "Không xác định";
            if (data.data != null) {
              //console.log("Hellllllo", data.data);
              if (data.data.full_name != null) {
                name = data.data.full_name;
              }
              if (data.data.gender == 1) {
                //Man
                src = "/src/assets/image/man.png";
              } else {
                src = "/src/assets/image/woman.png";
              }
              $("#img-customer-calling-small").attr("src", src);

              $(".img-customer-calling-bigg").attr("src", src);

              // $('#customer_detail').addClass("show");
              renderCustomerInfo(data.data);
              $("#idCallCustomer").val(data.data.id);
              // getInvoicedCustomer(data.data.id);
              localStorage.setItem("idUser", JSON.stringify(data.data));
              //$("#checkTrue").removeClass("dd-none");
              //$("#checkTrue").addClass("dd-block");
              //$("#checkFalse").removeClass("dd-block");
              //$("#checkFalse").addClass("dd-none");
            } else {
              $("#customerInformation").addClass("show");
              $("#phone_add").val(phone);
              localStorage.setItem("idUser", -1);
              //$("#checkTrue").removeClass("dd-block");
              //$("#checkTrue").addClass("dd-none");
              //$("#checkFalse").removeClass("dd-none");
              //$("#checkFalse").addClass("dd-block");
              $("#idCallCustomer").val(-1);
              renderCustomerInfo(-1);
            }

            // else {
            //     let valPhone =
            //         `
            //         <div class="label-required nameVar">
            //             {{ __('Điện thoại') }}
            //         </div>
            //         <input autocomplete="off" type="number" class="form-control" name="phone" id="phone_add" value="` +
            //         phone + `" required>
            //     `
            //     $("#phone").html(valPhone);
            //     // $("#customerInformation").addClass("show");
            // }
            $(".phone-customer-calling").empty().html(phone);
            $(".name-customer-calling").empty().html(name);

            // if (data.status == 200) {
            //     $('.name-customer-calling').empty().html(data.data.name);
            // }
          },
        });
      }

      function renderCustomerInfo(data) {
        if (data != -1) {
          $("#imgNoCustommer").addClass("d-none");
          $("#infoCustommer").removeClass("d-none");

          //console.log("ghdgjvfsjhfd", data);
          $("#typeCustomer").text(data.group_id_customer);
          $("#sexCustommer").text(data.set_gender);
          // if(data.group_id == 1){
          //     $("#typeCustomer").text("VIP");
          // }else{
          //     $("#typeCustomer").text("Phổ thông");
          // }

          if (data.gender == 1) {
            $("#picture").html(
              `<img class="image" src="/src/assets/image/man.png" alt="">`
            );
          } else {
            $("#sexCustommer").text("Nữ");
            $("#picture").html(
              `<img class="image" src="/src/assets/image/woman.png'" alt="">`
            );
          }
          data.birthday
            ? $("#birthdayCustommer").text(data.birthday)
            : $("#birthdayCustommer").text("Không có");
          data.name
            ? $("#nameCustomer").text(data.name)
            : $("#nameCustomer").text("Không có");
          data.phone
            ? $("#sdtCustommer").text(data.phone)
            : $("#sdtCustommer").text("Không có");
          data.email
            ? $("#emailCustommer").text(data.email)
            : $("#emailCustommer").text("Không có");
          data.address
            ? $("#addressCustommer").text(data.address)
            : $("#addressCustommer").text("Không có");
          data.note
            ? $("#NoteCustommer").text(data.note)
            : $("#NoteCustommer").text("Không có");
        } else {
          $("#infoCustommer").addClass("d-none");
          $("#imgNoCustommer").removeClass("d-none");
        }
      }

      /**
       * It empties the contents of the divs with the class names phone-customer-calling and
       * name-customer-calling, and sets the src attribute of the img tags with the ids
       * img-customer-calling-bigg and img-customer-calling-small to the default avatar image
       */
      function emptyInfoCall() {
        path = "/src/assets/image/avatar_default.png"; // Bỏ cổng khi đưa web
        $(".phone-customer-calling").empty().html("");
        $(".name-customer-calling").empty().html("");
        $(".img-customer-calling-bigg").attr("src", path);
        $("#img-customer-calling-small").attr("src", path);
      }

      /**
       * It takes the data-phone, data-key, and data-label attributes from the phone-incall class and
       * inserts them into the info-number-call class
       */
      function getInfoNumberCall() {
        var infoNumberCall = $(".phone-incall").attr("data-phone");
        var infoNumberKey = $(".phone-incall").attr("data-key");
        var infoLabel = $(".phone-incall").attr("data-label");
        $(".info-number-call").attr("data-phone", infoNumberCall);
        $(".info-number-call").attr("data-key", infoNumberKey);
        $(".info-number-call").attr("data-label", infoLabel);
        //inset html info-number-call > span
        var html =
          '<span class="info-number-call" data-phone="' +
          infoNumberCall +
          '" data-key="' +
          infoNumberKey +
          '" data-label="' +
          infoLabel +
          '">' +
          infoNumberCall +
          "</span>";
        $(".info-number-call").empty().html(html);
      }

      /**
       * A function that is used to call the phone number.
       */

      function csdPhoneClient() {
        getSpeedInternet();
        checkStatusWhenBtnChangeStatusExtension();
        checkStatus = checkStatusExt();
        if (checkStatus != 1) {
          //Notiflix.Notify.info("Ip phone chưa online, vui lòng kiểm tra lại");
          btnChangeStatusExtension();
          return;
        }
        resetWatchInCall();
        var keyPhone = $(".phone-incall").attr("data-key");
        var phone = $("#number-phone").val();
        if (phone == "") {
          // toastr.error('Chưa nhập số điện thoại');
          //Notiflix.Notify.info("Chưa nhập số điện thoại");
          return;
        }
        btnOffModalCall();
        $(".info-call").show();
        getInfoCustomer(phone);
        setTimeStartCall();
        uiWhenCallOutgoing();
        getInfoNumberCall();
        // Số key + phone để gọi

        var phoneEnd = "";
        if (keyPhone == 1) {
          phoneEnd = phone;
        } else {
          phoneEnd = keyPhone + phone;
        }
        ctxSip.sipCall(phoneEnd);
        $("#number-phone").val("");
        $("#session-btn-right").hide();
        callingOut = "has";
      }

      function uiWhenCallOutgoing() {
        resetWatchInCall();
        $(".btn-accept-call-big").hide();
        $(".btn-accept-call-small").hide();
        $(".count-watch-in-call-big").show();
        $(".count-watch-in-call-small").show();
      }

      function clientAcceptCall(sessionid) {
        //console.log("clientAcceptCall", sessionid);
        var idSessionCall = localStorage.getItem("idSessionCall");
        var callId = localStorage.getItem("call_id");
        $("#comment").attr("data-callid", callId);
        getSpeedInternet();
        if (idSessionCall == sessionid) {
          addAnimationWhenAcceptCall();
          setCountWatchInCall();
          $("#session-btn-right").hide();
          callingIn = "has";
        } else {
          //.error("Không phải cuộc gọi đến");
        }
      }
      /**
       * A timer that counts the time of the call.
       */
      let timerId = null;
      var callingIn = "not";
      var callingOut = "not";
      var speedInternet;

      function setCountWatchInCall() {
        let seconds = 0;
        timerId = setInterval(function () {
          seconds++;
          let hours = addLeadingZeros(Math.floor(seconds / 3600));
          let minutes = addLeadingZeros(Math.floor((seconds % 3600) / 60));
          let remainingSeconds = addLeadingZeros(seconds % 60);
          document.getElementById("count-watch-in-call-small").innerHTML =
            hours + ":" + minutes + ":" + remainingSeconds;
          document.getElementById("count-watch-in-call-big").innerHTML =
            hours + ":" + minutes + ":" + remainingSeconds;
        }, 1000);
      }

      /**
       * It takes the current time, and then subtracts the time that the call was started.
       *
       * The result is the time that the call has been going on for.
       *
       * The function then takes that time, and converts it into a format that we can use.
       *
       * The format is:
       */
      function resetWatchInCall() {
        clearInterval(timerId);
        clearInterval(timerId);
        document.getElementById("count-watch-in-call-small").innerHTML =
          "Đang kết nối...";
        document.getElementById("count-watch-in-call-big").innerHTML =
          "Đang kết nối...";
      }

      function resetWatchEndCallTemp() {
        clearInterval(timerId);
        clearInterval(timerId);
        clearInterval(timerId);
        clearInterval(timerId);
      }
      /**
       * It sets the time start call to the current time.
       */
      function setTimeStartCall() {
        // time-start-call
        var d = new Date();
        // get Hour and minute
        var hour = d.getHours();
        var minute = d.getMinutes();
        if (hour < 10) {
          hour = "0" + hour;
        }
        if (minute < 10) {
          minute = "0" + minute;
        }
        // set time start call
        document.getElementById("time-start-call").innerHTML =
          hour + ":" + minute;
      }

      function addLeadingZeros(number) {
        return (number < 10 ? "0" : "") + number;
      }

      /**
       *
       */
      function setStatusCall(status) {
        if (status == "calling") {
          $(".status-call").empty().html("Đang gọi đi ");
        } else if (status == "ringing") {
          $(".status-call").empty().html("Cuộc gọi đến");
        } else {
          $(".status-call").empty().html("Kết thúc");
        }
      }

      /**
       * It hides the buttons that are used to accept and end calls
       */
      function setDefaultButtonCall() {
        $("#btn-end-call-small").hide();
        $("#btn-end-call-big").hide();
        $("#btn-accept-call-big").hide();
        $("#btn-accept-call-small").hide();
      }
      /**
       * It accepts the call.
       */

      async function answerByCallCenter() {
        let call = await JSON.parse(localStorage.getItem("checkStream"));
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/answerByCallCenter",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "POST",
          data: {
            call_id: call.call_id,
            phone: call.phone,
            answer_on_wss: 1,
          },
          success: function (data) {
            console.log("data answerByCallCenter", data);
          },
        });
      }

      async function acceptCall() {
        var idSessionCall = localStorage.getItem("idSessionCall");
        await answerByCallCenter();
        callingIn = "has";
        /* The above code is adding the class animate__animated and animate__fadeOutRight to the
          element with the class btn-accept-call-big. */
        const elementButtonAcceptBig = document.querySelector(
          ".btn-accept-call-big"
        );
        elementButtonAcceptBig.classList.add(
          "animate__animated",
          "animate__fadeOutRight"
        );
        const elementButtonAcceptSmall = document.querySelector(
          ".btn-accept-call-small"
        );
        elementButtonAcceptSmall.classList.add(
          "animate__animated",
          "animate__fadeOutRight"
        );

        addAnimationWhenAcceptCall();
        elementButtonAcceptBig.style.display = "none";
        elementButtonAcceptSmall.style.display = "none";

        // setCountWatchInCall();

        $("#session-btn-right").hide();
        getSpeedInternet();

        ctxSip.phoneCallButtonPressed(idSessionCall);
      }

      var animationButtonAccept = "";

      function addAnimationButtonIncomingCall() {
        const elementButtonAcceptBig = document.querySelector(
          ".btn-accept-call-big"
        );
        const elementButtonAcceptSmall = document.querySelector(
          ".btn-accept-call-small"
        );

        elementButtonAcceptBig.classList.add(
          "animate__animated",
          "animate__shakeX"
        );
        elementButtonAcceptSmall.classList.add(
          "animate__animated",
          "animate__shakeX"
        );
      }

      function OffAnimationButtonEndCall() {
        //
        const elementButtonAcceptBig = document.querySelector(
          ".btn-accept-call-big"
        );
        elementButtonAcceptBig.classList.remove(
          "animate__animated",
          "animate__fadeOutRight"
        );
        elementButtonAcceptBig.classList.remove(
          "animate__animated",
          "animate__shakeX"
        );
        elementButtonAcceptBig.style.display = "flex";

        const elementButtonAcceptSmall = document.querySelector(
          ".btn-accept-call-small"
        );
        elementButtonAcceptSmall.classList.remove(
          "animate__animated",
          "animate__fadeOutRight"
        );
        elementButtonAcceptSmall.classList.remove(
          "animate__animated",
          "animate__shakeX"
        );
        elementButtonAcceptSmall.style.display = "flex";

        const elementButtonEnd = document.querySelector(".btn-end-call-big");
        elementButtonEnd.classList.remove(
          "animate__animated",
          "animate__fadeIn"
        );
      }
      /**
      It make speed internet
      */
      function clearSpeedInternet() {
        clearInterval(speedInternet);
        clearInterval(speedInternet);
        clearInterval(speedInternet);
        clearInterval(speedInternet);
        clearInterval(speedInternet);
        clearInterval(speedInternet);
        $("#status-watch-in-call-big").show();
        $("#status-watch-in-call-small").show();
        // $('#speedInternetRealtime').empty().html('');
        // $('#speedInternet').hide();
      }

      function getSpeedInternet() {
        $(".speedInternet").show();
        $("#status-watch-in-call-big").hide();
        $("#status-watch-in-call-small").hide();
        //speed internet real time
        const connection =
          navigator.connection ||
          navigator.mozConnection ||
          navigator.webkitConnection;
        if (connection) {
          speedInternet = setInterval(function () {
            type = connection.effectiveType;
            $(".internetSpeedRealtime")
              .empty()
              .html(type + " " + connection.downlink + " Mbps");
          }, 1000);
        } else {
          //console.log("Network information API is not supported");
        }
      }

      /**
       * It adds animation to the element when the call ends.
       */
      function addAnimationWhenAcceptCall() {
        const elementCount = document.querySelector(".count-watch-in-call-big");
        elementCount.classList.add("animate__animated", "animate__fadeInLeft");
        const elementStatus = document.querySelector(
          "#status-watch-in-call-big"
        );
        elementCount.style.display = "block";
        // elementStatus.style.display = 'block';

        const elementCountSmall = document.querySelector(
          ".count-watch-in-call-small"
        );
        elementCountSmall.classList.add(
          "animate__animated",
          "animate__fadeInLeft"
        );
        const elementStatusSmall = document.querySelector(
          "#status-watch-in-call-small"
        );
        elementCountSmall.style.display = "block";
        // elementStatusSmall.style.display = 'block';
      }

      /**
       * It removes the animation when the call ends.
       */
      function removeAnimationWhenEndCall() {
        const elementCount = document.querySelector(".count-watch-in-call-big");
        elementCount.classList.remove(
          "animate__animated",
          "animate__fadeInLeft"
        );
        $(".count-watch-in-call-big").hide();
        $("#status-watch-in-call-big").hide();
        $(".count-watch-in-call-small").hide();
        $("#status-watch-in-call-small").hide();
      }
      /**
       * A function that is called when the call is ended.
       */

      function endCallWss(sessionid) {
        //console.log("endCallWss", callingIn);
        /* if callingIn == true no endCall  && $('btn-ended-call-big') is not class ended-call*/
        if (callingIn === "has") {
          clearInterval(timerId);
          resetWatchEndCallTemp();
          $("#btn-end-call-small").hide();
          $("#btn-end-call-big").hide();
          $("#btn-ended-call-small").show().addClass("ended-call");
          $("#btn-ended-call-big").show().addClass("ended-call");
          callingIn = "not";
        } else {
          clearSpeedInternet();
          resetWatchInCall();
          removeAnimationWhenEndCall();
          OffAnimationButtonEndCall();
          var idSessionCall = localStorage.getItem("idSessionCall");
          if (idSessionCall == sessionid) {
            $("#session-btn-right").hide();
            $(".info-call").hide();
            $(".screen-small").hide();
            btnOffModalCall();
            emptyInfoCall();
          } else {
            // toastr.error('Không tìm thấy cuộc gọi');
          }
          localStorage.removeItem("idSessionCall");
        }
      }

      /**
       * It ends the call.
       */
      function endCallTemp() {
        var idSessionCall = localStorage.getItem("idSessionCall");
        ctxSip.sipHangUp(idSessionCall);
        localStorage.removeItem("idSessionCall");
        checkStatusWhenBtnChangeStatusExtension();

        //if (callingOut === "has") {
        //  endCall();
        //  callingOut = "not";
        //}
      }

      function endCall() {
        clearSpeedInternet();
        resetWatchInCall();
        removeAnimationWhenEndCall();
        OffAnimationButtonEndCall();
        $("#session-btn-right").hide();
        $(".info-call").hide();
        $(".screen-small").hide();
        $("#btn-end-call-small").show();
        $("#btn-end-call-big").show();
        $("#btn-ended-call-small").hide().removeClass("ended-call");
        $("#btn-ended-call-big").hide().removeClass("ended-call");
        btnOffModalCall();
        emptyInfoCall();
        // var idSessionCall = localStorage.getItem('idSessionCall');
        // ctxSip.sipHangUp(idSessionCall);
        localStorage.removeItem("idSessionCall");

        // clearInterval(timerId);
      }

      function updateActivePhoneDB(id) {
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/active-phone",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "POST",
          data: {
            id: id,
          },
          success: function (data) {
            if (data.result) {
              //console.log("Cập nhật thành công");
            } else {
              //console.log("Cập nhật thất bại");
            }
          },
        });
      }
      //check permission use microphone and camera
      // function checkPermission() {
      //     var check = false;
      //     navigator.mediaDevices.getUserMedia({
      //             audio: true,
      //         })
      //         .then(function(stream) {
      //             //console.log('Permission Granted!');
      //             stream.getTracks().forEach(function(track) {
      //                 track.stop();
      //             });
      //             check = true;
      //         })
      //         .catch(function(err) {
      //             //Notiflix.Notify.info('Vui lòng cấp quyền truy cập microphone và camera');
      //             check = false;
      //         });
      //     return check;
      // }
      // checkPermission();
      //console.log("checkxy", xy);
      //console.log("checkToken", token);

      function openModalTickets() {
        collapseModalInfoCall();
        $("#isOpen").removeClass(
          "transition-all delay-200 opacity-0 translate-x-full"
        );
        $("#checkModal").removeClass("translate-x-full");
        $("#isOpen").addClass(
          "transition-opacity opacity-100 duration-500 translate-x-0"
        );
        $("#checkModal").addClass("translate-x-0");
      }

      function handleclose() {
        $("#isOpen").addClass(
          "transition-all delay-200 opacity-0 translate-x-full"
        );
        $("#checkModal").addClass("translate-x-full");
        $("#isOpen").removeClass(
          "transition-opacity opacity-100 duration-500 translate-x-0"
        );
        $("#checkModal").removeClass("translate-x-0");
      }

      if (xy < 0) {
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/features-call-center",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "GET",
          success: function (data) {
            console.log("data", data);
            if (data.result) {
              if (data.active == 1) {
                $("#session-btn-right").addClass("show");
                if (data.phone.length == 0) {
                  // toastr.error('Chưa kết nối phone');
                  //Notiflix.Notify.info("Chưa kết nối phone", () => {
                  //  alert(
                  //    "Vui lòng reset trình duyệt và thử lại, nếu vẫn không được vui lòng liên hệ với quản trị viên"
                  //  );
                  //});
                } else {
                  /* Update status extension */
                  var status_ext = data.user.status_ext;
                  if (status_ext != null) {
                    updateStatusExtensionLoading(status_ext);
                  }

                  /* End update status extension */
                  var option_phone = "";
                  arrayNumberCall = data.phone;
                  data.phone.forEach(function (item) {
                    if (item.in_call == 1) {
                      $(".phone-incall").html(item.phone);
                      $(".phone-incall").attr("data-key", item.key);
                      $(".phone-incall").attr("data-label", item.name_group);
                      $(".phone-incall").attr("data-phone", item.phone);
                      // localStorage.setItem('SIPCreds', JSON.stringify(item));
                      option_phone +=
                        '<div class="jss81" style="height: unset;">';
                      option_phone +=
                        '<div   data-label ="' +
                        item.name_group +
                        '" data-key ="' +
                        item.key +
                        '"  data-id ="' +
                        item.id +
                        '"  data-number="' +
                        item.phone +
                        '" class="jss616 active">';
                      option_phone += "<div>" + item.phone + "</div>";
                      option_phone +=
                        "<div><span>" +
                        item.name_group +
                        '</span><span style="display: none;"> ' +
                        item.phone +
                        "</span></div>";
                      option_phone += "</div>";
                      option_phone += "</div>";
                    } else {
                      option_phone +=
                        '<div class="jss81" style="height: unset;">';
                      option_phone +=
                        '<div  data-label ="' +
                        item.name_group +
                        '" data-key ="' +
                        item.key +
                        '"  data-id ="' +
                        item.id +
                        '"  data-number="' +
                        item.phone +
                        '" class="jss616">';
                      option_phone += "<div>" + item.phone + "</div>";
                      option_phone +=
                        "<div><span>" +
                        item.name_group +
                        '</span><span style="display: none;"> ' +
                        item.phone +
                        "</span></div>";
                      option_phone += "</div>";
                      option_phone += "</div>";
                    }
                  });
                  $(".option-phone").html(option_phone);
                  $(".jss81").hover(
                    function () {
                      $(this).attr(
                        "style",
                        "background-color: rgba(14, 171, 175, .12) !important"
                      );
                    },
                    function () {
                      $(this).attr(
                        "style",
                        "background-color: #fff !important"
                      );
                    }
                  );
                  $(".jss81").click(function () {
                    $(".jss616").removeClass("active");
                    $(this).find(".jss616").addClass("active");
                    $(this).parent().prepend($(this));
                    $(".phone-incall").html(
                      $(this).find(".jss616").attr("data-number")
                    );
                    $(".phone-incall").attr(
                      "data-phone",
                      $(this).find(".jss616").attr("data-number")
                    );
                    $(".phone-incall").attr(
                      "data-key",
                      $(this).find(".jss616").attr("data-key")
                    );
                    $(".phone-incall").attr(
                      "data-label",
                      $(this).find(".jss616").attr("data-label")
                    );
                    $(".jss615").removeClass("show");
                    // update active phone on db
                    updateActivePhoneDB(
                      $(this).find(".jss616").attr("data-id")
                    );
                  });
                }
                /*  */
                var user = {
                  Display: data.user.extension,
                  User: data.user.extension,
                  WSServer: data.wss,
                  Pass: data.password,
                  Realm: data.domain,
                };
                // //console.log(user);
                if (typeof user === "undefined") {
                  // toastr.error('Vui lòng kiểm tra lại thông số kết nối');\
                  //Notiflix.Notify.info(
                  //  "Vui lòng kiểm tra lại thông số kết nối",
                  //  () => {
                  //    alert(
                  //      "Vui lòng reset trình duyệt và thử lại, nếu vẫn không được vui lòng liên hệ với quản trị viên"
                  //    );
                  //  }
                  //);
                  // user = JSON.parse(localStorage.getItem('SIPCreds'));
                }
                ctxSip = {
                  config: {
                    media: {
                      remote: {
                        video: document.getElementById("audioRemote"),
                        audio: document.getElementById("audioRemote"),
                      },
                    },
                    peerConnectionOptions: {
                      rtcConfiguration: {
                        iceServers: [
                          {
                            urls: "stun:sips.uptic.eu:3478",
                          },
                        ],
                      },
                    },
                    password: user.Pass,
                    authorizationUser: user.User,
                    displayName: user.Display,
                    uri: user.User + "@" + user.Realm,
                    transportOptions: {
                      traceSip: true,
                      wsServers: user.WSServer,
                    },
                    registerExpires: 30,
                    ua: {},
                  },
                  ringtone: document.getElementById("ringtone"),
                  ringbacktone: document.getElementById("ringbacktone"),
                  dtmfTone: document.getElementById("dtmfTone"),

                  Sessions: [],
                  callTimers: {},
                  callActiveID: null,
                  callVolume: 1,
                  Stream: null,

                  /**
                   * Parses a SIP uri and returns a formatted US phone number.
                   *
                   * @param  {string} phone number or uri to format
                   * @return {string}       formatted number
                   */
                  formatPhone: function (phone) {
                    var num;

                    if (phone.indexOf("@")) {
                      num = phone.split("@")[0];
                    } else {
                      num = phone;
                    }

                    num = num.toString().replace(/[^0-9]/g, "");

                    if (num.length === 10) {
                      return (
                        "(" +
                        num.substr(0, 3) +
                        ") " +
                        num.substr(3, 3) +
                        "-" +
                        num.substr(6, 4)
                      );
                    } else if (num.length === 11) {
                      return (
                        "(" +
                        num.substr(1, 3) +
                        ") " +
                        num.substr(4, 3) +
                        "-" +
                        num.substr(7, 4)
                      );
                    } else {
                      return num;
                    }
                  },

                  // Sound methods
                  startRingTone: function () {
                    try {
                      ctxSip.ringtone.play();
                    } catch (e) {}
                  },

                  stopRingTone: function () {
                    try {
                      ctxSip.ringtone.pause();
                    } catch (e) {}
                  },

                  startRingbackTone: function () {
                    try {
                      ctxSip.ringbacktone.play();
                    } catch (e) {}
                  },

                  stopRingbackTone: function () {
                    try {
                      ctxSip.ringbacktone.pause();
                    } catch (e) {}
                  },

                  // Genereates a rendom string to ID a call
                  getUniqueID: function () {
                    return Math.random().toString(36).substr(2, 9);
                  },

                  newSession: function (newSess) {
                    // ctxSip.logClear();
                    newSess.displayName =
                      newSess.remoteIdentity.displayName ||
                      newSess.remoteIdentity.uri.user;
                    newSess.ctxid = ctxSip.getUniqueID();
                    // var status;

                    localStorage.setItem("idSessionCall", newSess.ctxid);
                    // //console.log("newSess.id", newSess)
                    localStorage.setItem("call_id", newSess.id);
                    if (newSess.direction === "incoming") {
                      csdIncomingPhoneClient(newSess);
                      // status = 'Incoming: ' + newSess.displayName;
                      ctxSip.startRingTone();
                    } else {
                      // status = 'Trying: ' + newSess.displayName;
                      ctxSip.startRingbackTone();
                    }

                    // ctxSip.logCall(newSess, 'ringing');

                    // ctxSip.setCallSessionStatus(status);

                    // EVENT CALLBACKS

                    //var remoteVideo = document.getElementById("audioRemote");
                    // var localVideo = document.getElementById("audioRemote");

                    //newSess.on("trackAdded", function () {
                    // We need to check the peer connection to determine which track was added

                    //  var pc = newSess.sessionDescriptionHandler.peerConnection;

                    // Gets remote tracks
                    //  var remoteStream = new MediaStream();
                    ///  pc.getReceivers().forEach(function (receiver) {
                    //   remoteStream.addTrack(receiver.track);
                    //  });
                    //  remoteVideo.srcObject = remoteStream;
                    //  remoteVideo.play();
                    //});

                    newSess.on("progress", function (e) {
                      if (e.direction === "outgoing") {
                        // ctxSip.setCallSessionStatus('Calling...');
                      }
                    });

                    newSess.on("connecting", function (e) {
                      if (e.direction === "outgoing") {
                        // ctxSip.setCallSessionStatus('Connecting...');
                      }
                    });

                    newSess.on("accepted", function (e) {
                      clientAcceptCall(newSess.ctxid);

                      // If there is another active call, hold it
                      if (
                        ctxSip.callActiveID &&
                        ctxSip.callActiveID !== newSess.ctxid
                      ) {
                        ctxSip.phoneHoldButtonPressed(ctxSip.callActiveID);
                      }

                      ctxSip.stopRingbackTone();
                      ctxSip.stopRingTone();
                      // ctxSip.setCallSessionStatus('Answered');
                      // ctxSip.logCall(newSess, 'answered');
                      ctxSip.callActiveID = newSess.ctxid;
                    });

                    newSess.on("hold", function (e) {
                      ctxSip.callActiveID = null;
                      // ctxSip.logCall(newSess, 'holding');
                    });

                    newSess.on("unhold", function (e) {
                      // //Notiflix.Notify.Succes
                      // ctxSip.logCall(newSess, 'resumed');
                      ctxSip.callActiveID = newSess.ctxid;
                    });

                    newSess.on("muted", function (e) {
                      // //Notiflix.Notify.Success('Đã tắt mic');
                      ctxSip.Sessions[newSess.ctxid].isMuted = true;
                      // ctxSip.setCallSessionStatus('Muted');
                    });

                    newSess.on("unmuted", function (e) {
                      // //Notiflix.Notify.Success('Đã bật mic');
                      ctxSip.Sessions[newSess.ctxid].isMuted = false;
                      // ctxSip.setCallSessionStatus('Answered');
                    });

                    newSess.on("cancel", function (e) {
                      //console.log("cancleeeeeeeeeee");
                      endCallWss(newSess.ctxid);
                      // clearInterval(timerId);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('Canceled');
                      if (this.direction === "outgoing") {
                        ctxSip.callActiveID = null;
                        newSess = null;
                        // ctxSip.logCall(this, 'ended');
                      }
                      // ctxSip.setStatus('Available');
                    });

                    newSess.on("bye", function (e) {
                      //console.log("byeeeeeeeeeeeeeeeeeeeeeeeeeeeeee");
                      endCallWss(newSess.ctxid);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('');
                      // ctxSip.logCall(newSess, 'ended');
                      ctxSip.callActiveID = null;
                      newSess = null;
                      // ctxSip.setStatus('Available');
                    });

                    newSess.on("failed", function (e) {
                      // //Notiflix.Notify.info('Cuộc gọi thất bại');
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('');
                    });

                    newSess.on("rejected", function (e) {
                      //Notiflix.Notify.info("Cuộc gọi bị hủy");

                      endCallWss(newSess.ctxid);
                      // clearInterval(timerId);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('Rejected');
                      ctxSip.callActiveID = null;
                      // ctxSip.logCall(this, 'ended');
                      newSess = null;
                    });

                    ctxSip.Sessions[newSess.ctxid] = newSess;
                  },

                  // getUser media request refused or device was not present
                  getUserMediaFailure: function (e) {
                    window.console.error("getUserMedia failed:", e);
                    // ctxSip.setError(
                    //     true,
                    //     'Media Error.',
                    //     'You must allow access to your microphone.  Check the address bar.',
                    //     true
                    // );
                    //Notiflix.Notify.info("Bạn chưa cho phép truy cập mic");
                    //require permission micro
                  },

                  getUserMediaSuccess: function (stream) {
                    ctxSip.Stream = stream;
                  },

                  /**
                   * sets the ui call status field
                   *
                   * @param {string} status
                   */
                  setCallSessionStatus: function (status) {
                    // $('#txtCallStatus').html(status);
                  },

                  /**
                   * sets the ui connection status field
                   *
                   * @param {string} status
                   */
                  setStatus: function (status) {
                    // $('#txtRegStatus').html('<i class="fa fa-signal"></i> ' + status);
                  },

                  /**
                   * logs a call to localstorage
                   *
                   * @param  {object} session
                   * @param  {string} status Enum 'ringing', 'answered', 'ended', 'holding', 'resumed'
                   */
                  logCall: function (session, status) {
                    // var log = {
                    //         clid: session.displayName,
                    //         uri: session.remoteIdentity.uri.toString(),
                    //         id: session.ctxid,
                    //         time: new Date().getTime(),
                    //     },
                    //     calllog = JSON.parse(localStorage.getItem('sipCalls'));
                    // if (!calllog) {
                    //     calllog = {};
                    // }
                    // if (!calllog.hasOwnProperty(session.ctxid)) {
                    //     calllog[log.id] = {
                    //         id: log.id,
                    //         clid: log.clid,
                    //         uri: log.uri,
                    //         start: log.time,
                    //         flow: session.direction,
                    //     };
                    // }
                    // if (status === 'ended') {
                    //     calllog[log.id].stop = log.time;
                    // }
                    // if (status === 'ended' && calllog[log.id].status === 'ringing') {
                    //     calllog[log.id].status = 'missed';
                    // } else {
                    //     calllog[log.id].status = status;
                    // }
                    // localStorage.setItem('sipCalls', JSON.stringify(calllog));
                    // ctxSip.logShow();
                  },

                  /**
                   * adds a ui item to the call log
                   *
                   * @param  {object} item log item
                   */
                  logItem: function (item) {
                    // var callActive = item.status !== 'ended' && item.status !==
                    //     'missed',
                    //     callLength =
                    //     item.status !== 'ended' ?
                    //     '<span id="' + item.id + '"></span>' :
                    //     moment.duration(item.stop - item.start).humanize(),
                    //     callClass = '',
                    //     callIcon,
                    //     i;
                    // switch (item.status) {
                    //     case 'ringing':
                    //         callClass = 'list-group-item-success';
                    //         callIcon = 'fa-bell';
                    //         break;
                    //     case 'missed':
                    //         callClass = 'list-group-item-danger';
                    //         if (item.flow === 'incoming') {
                    //             callIcon = 'fa-chevron-left';
                    //         }
                    //         if (item.flow === 'outgoing') {
                    //             callIcon = 'fa-chevron-right';
                    //         }
                    //         break;
                    //     case 'holding':
                    //         callClass = 'list-group-item-warning';
                    //         callIcon = 'fa-pause';
                    //         break;
                    //     case 'answered':
                    //         break;
                    //     case 'resumed':
                    //         callClass = 'list-group-item-info';
                    //         callIcon = 'fa-phone-square';
                    //         break;
                    //     case 'ended':
                    //         if (item.flow === 'incoming') {
                    //             callIcon = 'fa-chevron-left';
                    //         }
                    //         if (item.flow === 'outgoing') {
                    //             callIcon = 'fa-chevron-right';
                    //         }
                    //         break;
                    // }
                    // i =
                    //     '<div class="list-group-item sip-logitem clearfix ' +
                    //     callClass +
                    //     '" data-uri="' +
                    //     item.uri +
                    //     '" data-sessionid="' +
                    //     item.id +
                    //     '" title="Double Click to Call">';
                    // i += '<div class="clearfix"><div class="pull-left">';
                    // i +=
                    //     '<i class="fa fa-fw ' +
                    //     callIcon +
                    //     ' fa-fw"></i> <strong>' +
                    //     ctxSip.formatPhone(item.uri) +
                    //     '</strong><br><small>' +
                    //     moment(item.start).format('MM-DD hh:mm a') +
                    //     '</small>';
                    // i += '</div>';
                    // i +=
                    //     '<div class="pull-left text-left"><em>' +
                    //     item.clid +
                    //     '</em><br>' +
                    //     callLength +
                    //     '</div></div>';
                    // if (callActive) {
                    //     i += '<div class="btn-group btn-group-xs pull-right">';
                    //     if (item.status === 'ringing' && item.flow === 'incoming') {
                    //         i +=
                    //             '<button class="btn btn-xs btn-success btnCall" title="Call"><i class="fa fa-phone"></i></button>';
                    //     } else {
                    //         i +=
                    //             '<button class="btn btn-xs btn-primary btnHoldResume" title="Hold"><i class="fa fa-pause"></i></button>';
                    //         i +=
                    //             '<button class="btn btn-xs btn-info btnTransfer" title="Transfer"><i class="fa fa-random"></i></button>';
                    //         i +=
                    //             '<button class="btn btn-xs btn-warning  btnMute" title="Mute"><i class="fa fa-fw fa-microphone"></i></button>';
                    //     }
                    //     i +=
                    //         '<button class="btn btn-xs btn-danger btnHangUp" title="Hangup"><i class="fa fa-stop"></i></button>';
                    //     i += '</div>';
                    // }
                    // i += '</div>';
                    // $('#sip-logitems').append(i);
                    // // Start call timer on answer
                    // if (item.status === 'answered') {
                    //     var tEle = document.getElementById(item.id);
                    //     ctxSip.callTimers[item.id] = new Stopwatch(tEle);
                    //     ctxSip.callTimers[item.id].start();
                    // }
                    // if (callActive && item.status !== 'ringing') {
                    //     ctxSip.callTimers[item.id].start({
                    //         startTime: item.start
                    //     });
                    // }
                    // $('#sip-logitems').scrollTop(0);
                  },

                  /**
                   * updates the call log ui
                   */
                  logShow: function () {
                    // var calllog = JSON.parse(localStorage.getItem('sipCalls')),
                    //     x = [];
                    // if (calllog !== null) {
                    //     $('#sip-splash').addClass('hide');
                    //     $('#sip-log').removeClass('hide');
                    //     // empty existing logs
                    //     $('#sip-logitems').empty();
                    //     // JS doesn't guarantee property order so
                    //     // create an array with the start time as
                    //     // the key and sort by that.
                    //     // Add start time to array
                    //     $.each(calllog, function(k, v) {
                    //         x.push(v);
                    //     });
                    //     // sort descending
                    //     x.sort(function(a, b) {
                    //         return b.start - a.start;
                    //     });
                    //     $.each(x, function(k, v) {
                    //         ctxSip.logItem(v);
                    //     });
                    // } else {
                    //     $('#sip-splash').removeClass('hide');
                    //     $('#sip-log').addClass('hide');
                    // }
                  },

                  /**
                   * removes log items from localstorage and updates the UI
                   */
                  logClear: function () {
                    // localStorage.removeItem('sipCalls');
                    // ctxSip.logShow();
                  },

                  sipCall: function (target) {
                    try {
                      var s = ctxSip.phone.invite(target, {
                        media: {
                          remote: {
                            video: document.getElementById("audioRemote"),
                            audio: document.getElementById("audioRemote"),
                          },
                        },
                        sessionDescriptionHandlerOptions: {
                          constraints: {
                            audio: true,
                            video: false,
                          },
                          rtcConfiguration: {
                            RTCConstraints: {
                              optional: [
                                {
                                  DtlsSrtpKeyAgreement: "true",
                                },
                              ],
                            },
                            stream: ctxSip.Stream,
                          },
                        },
                      });
                      s.direction = "outgoing";
                      ctxSip.newSession(s);

                      //var remoteVideo = document.getElementById("audioRemote");
                      //var localVideo = document.getElementById("audioRemote");

                      //s.on("trackAdded", function () {
                      // We need to check the peer connection to determine which track was added

                      //  var pc = s.sessionDescriptionHandler.peerConnection;

                      // Gets remote tracks
                      //  var remoteStream = new MediaStream();
                      //  pc.getReceivers().forEach(function (receiver) {
                      //     remoteStream.addTrack(receiver.track);
                      //  });
                      //  remoteVideo.srcObject = remoteStream;
                      //  remoteVideo.play();
                      //});
                    } catch (e) {
                      throw e;
                    }
                  },

                  sipTransfer: function (sessionid) {
                    // var s = ctxSip.Sessions[sessionid];
                    // var numberDisplay = document.getElementById('numDisplay');
                    // var target = window.prompt('Enter destination number', '');
                    // document.getElementById('transferButton').click();
                    // numberDisplay.value = target;
                    // ctxSip.sipSendDTMF(target);
                    // ctxSip.phoneCallButtonPressed(sessionid);
                    // ctxSip.setCallSessionStatus('<i>Transfering the call...</i>');
                  },

                  sipHangUp: function (sessionid) {
                    endCallWss(sessionid);
                    var s = ctxSip.Sessions[sessionid];
                    // //console.log("🚀 ~ file: app.js:638 ~ s", s)

                    s.terminate();
                    if (!s) {
                      return;
                    } else if (s.startTime) {
                      s.bye();
                    } else if (s.reject) {
                      s.reject();
                    } else if (s.cancel) {
                      s.cancel();
                    }
                  },

                  sipSendDTMF: function (digit) {
                    try {
                      ctxSip.dtmfTone.play();
                    } catch (e) {}

                    var a = ctxSip.callActiveID;
                    if (a) {
                      var s = ctxSip.Sessions[a];
                      s.dtmf(digit);
                    }
                  },

                  phoneCallButtonPressed: function (sessionid) {
                    // //console.log('Chấp nhận cuộc gọi');
                    var s = ctxSip.Sessions[sessionid];
                    // var target = $('#numDisplay').val();

                    if (!s) {
                      // $('#numDisplay').val('');
                      // ctxSip.sipCall(target);
                    } else if (s.accept && !s.startTime) {
                      s.accept({
                        media: {
                          remote: {
                            video: document.getElementById("audioRemote"),
                            audio: document.getElementById("audioRemote"),
                          },
                        },
                        sessionDescriptionHandlerOptions: {
                          constraints: {
                            audio: true,
                            video: false,
                          },
                          rtcConfiguration: {
                            RTCConstraints: {
                              optional: [
                                {
                                  DtlsSrtpKeyAgreement: "true",
                                },
                              ],
                            },
                            stream: ctxSip.Stream,
                          },
                        },
                      });
                      // setCountWatchInCall();
                    }
                  },

                  phoneMuteButtonPressed: function (sessionid) {
                    var s = ctxSip.Sessions[sessionid];

                    if (!s.isMuted) {
                      s.mute();
                    } else {
                      s.unmute();
                    }
                  },

                  phoneHoldButtonPressed: function (sessionid) {
                    var s = ctxSip.Sessions[sessionid];

                    if (s.isOnHold().local === true) {
                      s.unhold();
                    } else {
                      s.hold();
                    }
                  },

                  setError: function (err, title, msg, closable) {
                    // Show modal if err = true
                    // if (err === true) {
                    //     $('#mdlError p').html(msg);
                    //     $('#mdlError').modal('show');
                    //     if (closable) {
                    //         var b =
                    //             '<button type="button" class="close" data-dismiss="modal">&times;</button>';
                    //         $('#mdlError .modal-header').find('button').remove();
                    //         $('#mdlError .modal-header').prepend(b);
                    //         $('#mdlError .modal-title').html(title);
                    //         $('#mdlError').modal({
                    //             keyboard: true
                    //         });
                    //     } else {
                    //         $('#mdlError .modal-header').find('button').remove();
                    //         $('#mdlError .modal-title').html(title);
                    //         $('#mdlError').modal({
                    //             keyboard: false
                    //         });
                    //     }
                    //     $('#numDisplay').prop('disabled', 'disabled');
                    // } else {
                    //     $('#numDisplay').removeProp('disabled');
                    //     $('#mdlError').modal('hide');
                    // }
                  },

                  /**
                   * Tests for a capable browser, return bool, and shows an
                   * error modal on fail.
                   */
                  hasWebRTC: function () {
                    if (navigator.webkitGetUserMedia) {
                      return true;
                    } else if (navigator.mozGetUserMedia) {
                      return true;
                    } else if (navigator.getUserMedia) {
                      return true;
                    } else {
                      // ctxSip.setError(
                      //     true,
                      //     'Unsupported Browser.',
                      //     'Your browser does not support the features required for this phone.'
                      // );
                      //Notiflix.Notify.Failure(
                      //  "Your browser does not support the features required for this phone."
                      //);
                      window.console.error("WebRTC support not found");
                      return false;
                    }
                  },
                };

                // Throw an error if the browser can't hack it.
                if (!ctxSip.hasWebRTC()) {
                  return true;
                }

                ctxSip.phone = new SIP.UA(ctxSip.config);

                ctxSip.phone.on("connected", function (e) {
                  // ctxSip.setStatus('Connected');
                  // ctxSip.setError(false);
                });

                ctxSip.phone.on("disconnected", function (e) {
                  // ctxSip.setStatus('Disconnected');
                  // disable phone
                  // ctxSip.setError(
                  //     true,
                  //     'Websocket Disconnected.',
                  //     'An Error occurred connecting to the websocket.'
                  // );
                  //Notiflix.Notify.Failure(
                  //  "An Error occurred connecting to the websocket."
                  //);
                });

                ctxSip.phone.on("registered", function (e) {
                  // toastr.success('Kết nối tổng đài thành công!');
                  //Notiflix.Notify.success("Kết nối tổng đài thành công!");
                  // ctxSip.setStatus('Registered');

                  // ctxSip.setError(false);
                  var closeEditorWarning = function () {
                    return "If you close this window, you will not be able to make or receive calls from your browser.";
                  };

                  var closePhone = function () {
                    // stop the phone on unload
                    localStorage.removeItem("ctxPhone");
                    ctxSip.phone.stop();
                  };

                  window.onbeforeunload = closeEditorWarning;
                  window.onunload = closePhone;

                  // This key is set to prevent multiple windows.
                  localStorage.setItem("ctxPhone", "true");

                  // $('#mldError').modal('hide');
                  // ctxSip.setStatus('Available');

                  // Get the userMedia and cache the stream
                  //    if (SIP.WebRTC.isSupported()) {
                  //        SIP.WebRTC.getUserMedia({ audio : true, video : false }, ctxSip.getUserMediaSuccess, ctxSip.getUserMediaFailure);
                  //    }
                });

                ctxSip.phone.on("registrationFailed", function (e) {
                  //Notiflix.Notify.info("Đang kết nối tổng đài!");
                  reloadConnect();
                  // ctxSip.setError(
                  //     true,
                  //     'Registration Error.',
                  //     'An Error occurred registering your phone. Check your settings.'
                  // );
                  // //Notiflix.Notify.Failure(
                  //     'An Error occurred registering your phone. Check your settings.'
                  // );
                  // ctxSip.setStatus('Error: Registration Failed');
                });
                var onConnect = 1;
                reloadConnect = function () {
                  if (onConnect < 50) {
                    // onconect is 10 25  //Notiflix
                    if (onConnect == 30) {
                      //Notiflix.Notify.info("Đang cố gắng kết nối...");
                    }
                    ctxSip.phone = new SIP.UA(ctxSip.config);

                    ctxSip.phone.on("connected", function (e) {
                      // ctxSip.setStatus('Connected');
                      // ctxSip.setError(false);
                    });

                    ctxSip.phone.on("disconnected", function (e) {
                      // ctxSip.setStatus('Disconnected');
                      // disable phone
                      // ctxSip.setError(
                      //     true,
                      //     'Websocket Disconnected.',
                      //     'An Error occurred connecting to the websocket.'
                      // );
                      //Notiflix.Notify.Failure(
                      //  "An Error occurred connecting to the websocket."
                      //);
                    });

                    ctxSip.phone.on("registered", function (e) {
                      // toastr.success('Kết nối tổng đài thành công!');
                      //Notiflix.Notify.success("Kết nối tổng đài thành công!");
                      // ctxSip.setStatus('Registered');

                      // ctxSip.setError(false);
                      var closeEditorWarning = function () {
                        return "If you close this window, you will not be able to make or receive calls from your browser.";
                      };

                      var closePhone = function () {
                        // stop the phone on unload
                        localStorage.removeItem("ctxPhone");
                        ctxSip.phone.stop();
                      };

                      window.onbeforeunload = closeEditorWarning;
                      window.onunload = closePhone;

                      // This key is set to prevent multiple windows.
                      localStorage.setItem("ctxPhone", "true");
                    });

                    ctxSip.phone.on("registrationFailed", function (e) {
                      reloadConnect();

                      // ctxSip.setStatus('Error: Registration Failed');
                    });

                    ctxSip.phone.on("unregistered", function (e) {
                      // toastr.error('Lỗi kết nối tổng đài, vui lòng load lại trang!');
                      // ctxSip.setStatus('Error: Registration Failed');
                    });
                    ctxSip.phone.on(
                      "invite",

                      function (incomingSession) {
                        var s = incomingSession;

                        s.direction = "incoming";
                        ctxSip.newSession(s);
                      }
                    );
                  } else {
                    //Notiflix.Notify.failure(
                    //  "Lỗi kết nối tổng đài, vui lòng liên hệ quản trị viên!"
                    //);
                  }
                  onConnect++;
                };
                ctxSip.phone.on("unregistered", function (e) {
                  // toastr.error('Lỗi kết nối tổng đài, vui lòng load lại trang!');
                  //Notiflix.Notify.Failure(
                  //  "An Error occurred registering your phone. Please wait while we try to connect it again."
                  //);
                  // ctxSip.setStatus('Error: Registration Failed');
                });
                ctxSip.phone.on(
                  "invite",

                  function (incomingSession) {
                    var s = incomingSession;

                    s.direction = "incoming";
                    ctxSip.newSession(s);
                  }
                );

                // Hide the spalsh after 3 secs.
                setTimeout(function () {
                  ctxSip.logShow();
                }, 3000);

                /**
                 * Stopwatch object used for call timers
                 *
                 * @param {dom element} elem
                 * @param {[object]} options
                 */
                var Stopwatch = function (elem, options) {
                  // private functions
                  function createTimer() {
                    return document.createElement("span");
                  }

                  var timer = createTimer(),
                    offset,
                    clock,
                    interval;

                  // default options
                  options = options || {};
                  options.delay = options.delay || 1000;
                  options.startTime = options.startTime || Date.now();

                  // append elements
                  // elem.appendChild(timer);

                  function start() {
                    if (!interval) {
                      offset = options.startTime;
                      interval = setInterval(update, options.delay);
                    }
                  }

                  function stop() {
                    if (interval) {
                      clearInterval(interval);
                      interval = null;
                    }
                  }

                  function reset() {
                    clock = 0;
                    render();
                  }

                  function update() {
                    clock += delta();
                    render();
                  }

                  function render() {
                    //timer.innerHTML = moment.utc(clock).format("mm:ss");
                  }

                  function delta() {
                    var now = Date.now(),
                      d = now - offset;

                    offset = now;
                    return d;
                  }

                  // initialize
                  reset();

                  // public API
                  this.start = start; //function() { start; }
                  this.stop = stop; //function() { stop; }
                };
              }
            } else {
              //toastr.error("WebRTC is not supported by your browser, please contact developer.");
            }
          },
        });
      }

      function loadCall() {
        console.log(
          "xsasdadjshfjsdgfjhfsjdfsdjhfskjfhgsdkjfshdfsgdhfsdfjkhdsgfjsdhfgksdjfhfgdhjfsdfjhdgfjsdhgfjsdgfsdjfhgsj"
        );
        $.ajax({
          url: "https://apicallcenter.smartvcc.vn/api/callcenter/features-call-center",
          headers: {
            Authorization: "Bearer " + token,
          },
          method: "GET",
          success: function (data) {
            console.log("data", data);
            if (data.result) {
              if (data.active == 1) {
                $("#session-btn-right").addClass("show");
                if (data.phone.length == 0) {
                  // toastr.error('Chưa kết nối phone');
                  //Notiflix.Notify.info("Chưa kết nối phone", () => {
                  //  alert(
                  //    "Vui lòng reset trình duyệt và thử lại, nếu vẫn không được vui lòng liên hệ với quản trị viên"
                  //  );
                  //});
                } else {
                  /* Update status extension */
                  var status_ext = data.user.status_ext;
                  if (status_ext != null) {
                    updateStatusExtensionLoading(status_ext);
                  }

                  /* End update status extension */
                  var option_phone = "";
                  arrayNumberCall = data.phone;
                  data.phone.forEach(function (item) {
                    if (item.in_call == 1) {
                      $(".phone-incall").html(item.phone);
                      $(".phone-incall").attr("data-key", item.key);
                      $(".phone-incall").attr("data-label", item.name_group);
                      $(".phone-incall").attr("data-phone", item.phone);
                      // localStorage.setItem('SIPCreds', JSON.stringify(item));
                      option_phone +=
                        '<div class="jss81" style="height: unset;">';
                      option_phone +=
                        '<div   data-label ="' +
                        item.name_group +
                        '" data-key ="' +
                        item.key +
                        '"  data-id ="' +
                        item.id +
                        '"  data-number="' +
                        item.phone +
                        '" class="jss616 active">';
                      option_phone += "<div>" + item.phone + "</div>";
                      option_phone +=
                        "<div><span>" +
                        item.name_group +
                        '</span><span style="display: none;"> ' +
                        item.phone +
                        "</span></div>";
                      option_phone += "</div>";
                      option_phone += "</div>";
                    } else {
                      option_phone +=
                        '<div class="jss81" style="height: unset;">';
                      option_phone +=
                        '<div  data-label ="' +
                        item.name_group +
                        '" data-key ="' +
                        item.key +
                        '"  data-id ="' +
                        item.id +
                        '"  data-number="' +
                        item.phone +
                        '" class="jss616">';
                      option_phone += "<div>" + item.phone + "</div>";
                      option_phone +=
                        "<div><span>" +
                        item.name_group +
                        '</span><span style="display: none;"> ' +
                        item.phone +
                        "</span></div>";
                      option_phone += "</div>";
                      option_phone += "</div>";
                    }
                  });
                  $(".option-phone").html(option_phone);
                  $(".jss81").hover(
                    function () {
                      $(this).attr(
                        "style",
                        "background-color: rgba(14, 171, 175, .12) !important"
                      );
                    },
                    function () {
                      $(this).attr(
                        "style",
                        "background-color: #fff !important"
                      );
                    }
                  );
                  $(".jss81").click(function () {
                    $(".jss616").removeClass("active");
                    $(this).find(".jss616").addClass("active");
                    $(this).parent().prepend($(this));
                    $(".phone-incall").html(
                      $(this).find(".jss616").attr("data-number")
                    );
                    $(".phone-incall").attr(
                      "data-phone",
                      $(this).find(".jss616").attr("data-number")
                    );
                    $(".phone-incall").attr(
                      "data-key",
                      $(this).find(".jss616").attr("data-key")
                    );
                    $(".phone-incall").attr(
                      "data-label",
                      $(this).find(".jss616").attr("data-label")
                    );
                    $(".jss615").removeClass("show");
                    // update active phone on db
                    updateActivePhoneDB(
                      $(this).find(".jss616").attr("data-id")
                    );
                  });
                }
                /*  */
                var user = {
                  Display: data.user.extension,
                  User: data.user.extension,
                  WSServer: data.wss,
                  Pass: data.password,
                  Realm: data.domain,
                };
                // //console.log(user);
                if (typeof user === "undefined") {
                  // toastr.error('Vui lòng kiểm tra lại thông số kết nối');\
                  //Notiflix.Notify.info(
                  //  "Vui lòng kiểm tra lại thông số kết nối",
                  //  () => {
                  //    alert(
                  //      "Vui lòng reset trình duyệt và thử lại, nếu vẫn không được vui lòng liên hệ với quản trị viên"
                  //    );
                  //  }
                  //);
                  // user = JSON.parse(localStorage.getItem('SIPCreds'));
                }
                ctxSip = {
                  config: {
                    media: {
                      remote: {
                        video: document.getElementById("audioRemote"),
                        audio: document.getElementById("audioRemote"),
                      },
                    },
                    peerConnectionOptions: {
                      rtcConfiguration: {
                        iceServers: [
                          {
                            urls: "stun:sips.uptic.eu:3478",
                          },
                        ],
                      },
                    },
                    password: user.Pass,
                    authorizationUser: user.User,
                    displayName: user.Display,
                    uri: user.User + "@" + user.Realm,
                    transportOptions: {
                      traceSip: true,
                      wsServers: user.WSServer,
                    },
                    registerExpires: 30,
                    ua: {},
                  },
                  ringtone: document.getElementById("ringtone"),
                  ringbacktone: document.getElementById("ringbacktone"),
                  dtmfTone: document.getElementById("dtmfTone"),

                  Sessions: [],
                  callTimers: {},
                  callActiveID: null,
                  callVolume: 1,
                  Stream: null,

                  /**
                   * Parses a SIP uri and returns a formatted US phone number.
                   *
                   * @param  {string} phone number or uri to format
                   * @return {string}       formatted number
                   */
                  formatPhone: function (phone) {
                    var num;

                    if (phone.indexOf("@")) {
                      num = phone.split("@")[0];
                    } else {
                      num = phone;
                    }

                    num = num.toString().replace(/[^0-9]/g, "");

                    if (num.length === 10) {
                      return (
                        "(" +
                        num.substr(0, 3) +
                        ") " +
                        num.substr(3, 3) +
                        "-" +
                        num.substr(6, 4)
                      );
                    } else if (num.length === 11) {
                      return (
                        "(" +
                        num.substr(1, 3) +
                        ") " +
                        num.substr(4, 3) +
                        "-" +
                        num.substr(7, 4)
                      );
                    } else {
                      return num;
                    }
                  },

                  // Sound methods
                  startRingTone: function () {
                    try {
                      ctxSip.ringtone.play();
                    } catch (e) {}
                  },

                  stopRingTone: function () {
                    try {
                      ctxSip.ringtone.pause();
                    } catch (e) {}
                  },

                  startRingbackTone: function () {
                    try {
                      ctxSip.ringbacktone.play();
                    } catch (e) {}
                  },

                  stopRingbackTone: function () {
                    try {
                      ctxSip.ringbacktone.pause();
                    } catch (e) {}
                  },

                  // Genereates a rendom string to ID a call
                  getUniqueID: function () {
                    return Math.random().toString(36).substr(2, 9);
                  },

                  newSession: function (newSess) {
                    // ctxSip.logClear();
                    newSess.displayName =
                      newSess.remoteIdentity.displayName ||
                      newSess.remoteIdentity.uri.user;
                    newSess.ctxid = ctxSip.getUniqueID();
                    // var status;

                    localStorage.setItem("idSessionCall", newSess.ctxid);
                    // //console.log("newSess.id", newSess)
                    localStorage.setItem("call_id", newSess.id);
                    if (newSess.direction === "incoming") {
                      csdIncomingPhoneClient(newSess);
                      // status = 'Incoming: ' + newSess.displayName;
                      ctxSip.startRingTone();
                    } else {
                      // status = 'Trying: ' + newSess.displayName;
                      ctxSip.startRingbackTone();
                    }

                    // ctxSip.logCall(newSess, 'ringing');

                    // ctxSip.setCallSessionStatus(status);

                    // EVENT CALLBACKS

                    //var remoteVideo = document.getElementById("audioRemote");
                    // var localVideo = document.getElementById("audioRemote");

                    //newSess.on("trackAdded", function () {
                    // We need to check the peer connection to determine which track was added

                    //  var pc = newSess.sessionDescriptionHandler.peerConnection;

                    // Gets remote tracks
                    //  var remoteStream = new MediaStream();
                    ///  pc.getReceivers().forEach(function (receiver) {
                    //   remoteStream.addTrack(receiver.track);
                    //  });
                    //  remoteVideo.srcObject = remoteStream;
                    //  remoteVideo.play();
                    //});

                    newSess.on("progress", function (e) {
                      if (e.direction === "outgoing") {
                        // ctxSip.setCallSessionStatus('Calling...');
                      }
                    });

                    newSess.on("connecting", function (e) {
                      if (e.direction === "outgoing") {
                        // ctxSip.setCallSessionStatus('Connecting...');
                      }
                    });

                    newSess.on("accepted", function (e) {
                      clientAcceptCall(newSess.ctxid);

                      // If there is another active call, hold it
                      if (
                        ctxSip.callActiveID &&
                        ctxSip.callActiveID !== newSess.ctxid
                      ) {
                        ctxSip.phoneHoldButtonPressed(ctxSip.callActiveID);
                      }

                      ctxSip.stopRingbackTone();
                      ctxSip.stopRingTone();
                      // ctxSip.setCallSessionStatus('Answered');
                      // ctxSip.logCall(newSess, 'answered');
                      ctxSip.callActiveID = newSess.ctxid;
                    });

                    newSess.on("hold", function (e) {
                      ctxSip.callActiveID = null;
                      // ctxSip.logCall(newSess, 'holding');
                    });

                    newSess.on("unhold", function (e) {
                      // //Notiflix.Notify.Succes
                      // ctxSip.logCall(newSess, 'resumed');
                      ctxSip.callActiveID = newSess.ctxid;
                    });

                    newSess.on("muted", function (e) {
                      // //Notiflix.Notify.Success('Đã tắt mic');
                      ctxSip.Sessions[newSess.ctxid].isMuted = true;
                      // ctxSip.setCallSessionStatus('Muted');
                    });

                    newSess.on("unmuted", function (e) {
                      // //Notiflix.Notify.Success('Đã bật mic');
                      ctxSip.Sessions[newSess.ctxid].isMuted = false;
                      // ctxSip.setCallSessionStatus('Answered');
                    });

                    newSess.on("cancel", function (e) {
                      //console.log("cancleeeeeeeeeee");
                      endCallWss(newSess.ctxid);
                      // clearInterval(timerId);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('Canceled');
                      if (this.direction === "outgoing") {
                        ctxSip.callActiveID = null;
                        newSess = null;
                        // ctxSip.logCall(this, 'ended');
                      }
                      // ctxSip.setStatus('Available');
                    });

                    newSess.on("bye", function (e) {
                      //console.log("byeeeeeeeeeeeeeeeeeeeeeeeeeeeeee");
                      endCallWss(newSess.ctxid);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('');
                      // ctxSip.logCall(newSess, 'ended');
                      ctxSip.callActiveID = null;
                      newSess = null;
                      // ctxSip.setStatus('Available');
                    });

                    newSess.on("failed", function (e) {
                      // //Notiflix.Notify.info('Cuộc gọi thất bại');
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('');
                    });

                    newSess.on("rejected", function (e) {
                      //Notiflix.Notify.info("Cuộc gọi bị hủy");

                      endCallWss(newSess.ctxid);
                      // clearInterval(timerId);
                      ctxSip.stopRingTone();
                      ctxSip.stopRingbackTone();
                      // ctxSip.setCallSessionStatus('Rejected');
                      ctxSip.callActiveID = null;
                      // ctxSip.logCall(this, 'ended');
                      newSess = null;
                    });

                    ctxSip.Sessions[newSess.ctxid] = newSess;
                  },

                  // getUser media request refused or device was not present
                  getUserMediaFailure: function (e) {
                    window.console.error("getUserMedia failed:", e);
                    // ctxSip.setError(
                    //     true,
                    //     'Media Error.',
                    //     'You must allow access to your microphone.  Check the address bar.',
                    //     true
                    // );
                    //Notiflix.Notify.info("Bạn chưa cho phép truy cập mic");
                    //require permission micro
                  },

                  getUserMediaSuccess: function (stream) {
                    ctxSip.Stream = stream;
                  },

                  /**
                   * sets the ui call status field
                   *
                   * @param {string} status
                   */
                  setCallSessionStatus: function (status) {
                    // $('#txtCallStatus').html(status);
                  },

                  /**
                   * sets the ui connection status field
                   *
                   * @param {string} status
                   */
                  setStatus: function (status) {
                    // $('#txtRegStatus').html('<i class="fa fa-signal"></i> ' + status);
                  },

                  /**
                   * logs a call to localstorage
                   *
                   * @param  {object} session
                   * @param  {string} status Enum 'ringing', 'answered', 'ended', 'holding', 'resumed'
                   */
                  logCall: function (session, status) {
                    // var log = {
                    //         clid: session.displayName,
                    //         uri: session.remoteIdentity.uri.toString(),
                    //         id: session.ctxid,
                    //         time: new Date().getTime(),
                    //     },
                    //     calllog = JSON.parse(localStorage.getItem('sipCalls'));
                    // if (!calllog) {
                    //     calllog = {};
                    // }
                    // if (!calllog.hasOwnProperty(session.ctxid)) {
                    //     calllog[log.id] = {
                    //         id: log.id,
                    //         clid: log.clid,
                    //         uri: log.uri,
                    //         start: log.time,
                    //         flow: session.direction,
                    //     };
                    // }
                    // if (status === 'ended') {
                    //     calllog[log.id].stop = log.time;
                    // }
                    // if (status === 'ended' && calllog[log.id].status === 'ringing') {
                    //     calllog[log.id].status = 'missed';
                    // } else {
                    //     calllog[log.id].status = status;
                    // }
                    // localStorage.setItem('sipCalls', JSON.stringify(calllog));
                    // ctxSip.logShow();
                  },

                  /**
                   * adds a ui item to the call log
                   *
                   * @param  {object} item log item
                   */
                  logItem: function (item) {
                    // var callActive = item.status !== 'ended' && item.status !==
                    //     'missed',
                    //     callLength =
                    //     item.status !== 'ended' ?
                    //     '<span id="' + item.id + '"></span>' :
                    //     moment.duration(item.stop - item.start).humanize(),
                    //     callClass = '',
                    //     callIcon,
                    //     i;
                    // switch (item.status) {
                    //     case 'ringing':
                    //         callClass = 'list-group-item-success';
                    //         callIcon = 'fa-bell';
                    //         break;
                    //     case 'missed':
                    //         callClass = 'list-group-item-danger';
                    //         if (item.flow === 'incoming') {
                    //             callIcon = 'fa-chevron-left';
                    //         }
                    //         if (item.flow === 'outgoing') {
                    //             callIcon = 'fa-chevron-right';
                    //         }
                    //         break;
                    //     case 'holding':
                    //         callClass = 'list-group-item-warning';
                    //         callIcon = 'fa-pause';
                    //         break;
                    //     case 'answered':
                    //         break;
                    //     case 'resumed':
                    //         callClass = 'list-group-item-info';
                    //         callIcon = 'fa-phone-square';
                    //         break;
                    //     case 'ended':
                    //         if (item.flow === 'incoming') {
                    //             callIcon = 'fa-chevron-left';
                    //         }
                    //         if (item.flow === 'outgoing') {
                    //             callIcon = 'fa-chevron-right';
                    //         }
                    //         break;
                    // }
                    // i =
                    //     '<div class="list-group-item sip-logitem clearfix ' +
                    //     callClass +
                    //     '" data-uri="' +
                    //     item.uri +
                    //     '" data-sessionid="' +
                    //     item.id +
                    //     '" title="Double Click to Call">';
                    // i += '<div class="clearfix"><div class="pull-left">';
                    // i +=
                    //     '<i class="fa fa-fw ' +
                    //     callIcon +
                    //     ' fa-fw"></i> <strong>' +
                    //     ctxSip.formatPhone(item.uri) +
                    //     '</strong><br><small>' +
                    //     moment(item.start).format('MM-DD hh:mm a') +
                    //     '</small>';
                    // i += '</div>';
                    // i +=
                    //     '<div class="pull-left text-left"><em>' +
                    //     item.clid +
                    //     '</em><br>' +
                    //     callLength +
                    //     '</div></div>';
                    // if (callActive) {
                    //     i += '<div class="btn-group btn-group-xs pull-right">';
                    //     if (item.status === 'ringing' && item.flow === 'incoming') {
                    //         i +=
                    //             '<button class="btn btn-xs btn-success btnCall" title="Call"><i class="fa fa-phone"></i></button>';
                    //     } else {
                    //         i +=
                    //             '<button class="btn btn-xs btn-primary btnHoldResume" title="Hold"><i class="fa fa-pause"></i></button>';
                    //         i +=
                    //             '<button class="btn btn-xs btn-info btnTransfer" title="Transfer"><i class="fa fa-random"></i></button>';
                    //         i +=
                    //             '<button class="btn btn-xs btn-warning  btnMute" title="Mute"><i class="fa fa-fw fa-microphone"></i></button>';
                    //     }
                    //     i +=
                    //         '<button class="btn btn-xs btn-danger btnHangUp" title="Hangup"><i class="fa fa-stop"></i></button>';
                    //     i += '</div>';
                    // }
                    // i += '</div>';
                    // $('#sip-logitems').append(i);
                    // // Start call timer on answer
                    // if (item.status === 'answered') {
                    //     var tEle = document.getElementById(item.id);
                    //     ctxSip.callTimers[item.id] = new Stopwatch(tEle);
                    //     ctxSip.callTimers[item.id].start();
                    // }
                    // if (callActive && item.status !== 'ringing') {
                    //     ctxSip.callTimers[item.id].start({
                    //         startTime: item.start
                    //     });
                    // }
                    // $('#sip-logitems').scrollTop(0);
                  },

                  /**
                   * updates the call log ui
                   */
                  logShow: function () {
                    // var calllog = JSON.parse(localStorage.getItem('sipCalls')),
                    //     x = [];
                    // if (calllog !== null) {
                    //     $('#sip-splash').addClass('hide');
                    //     $('#sip-log').removeClass('hide');
                    //     // empty existing logs
                    //     $('#sip-logitems').empty();
                    //     // JS doesn't guarantee property order so
                    //     // create an array with the start time as
                    //     // the key and sort by that.
                    //     // Add start time to array
                    //     $.each(calllog, function(k, v) {
                    //         x.push(v);
                    //     });
                    //     // sort descending
                    //     x.sort(function(a, b) {
                    //         return b.start - a.start;
                    //     });
                    //     $.each(x, function(k, v) {
                    //         ctxSip.logItem(v);
                    //     });
                    // } else {
                    //     $('#sip-splash').removeClass('hide');
                    //     $('#sip-log').addClass('hide');
                    // }
                  },

                  /**
                   * removes log items from localstorage and updates the UI
                   */
                  logClear: function () {
                    // localStorage.removeItem('sipCalls');
                    // ctxSip.logShow();
                  },

                  sipCall: function (target) {
                    try {
                      //if (!ctxSip.phone) {
                      //  return;
                      //}
                      var s = ctxSip.phone.invite(target, {
                        media: {
                          remote: {
                            video: document.getElementById("audioRemote"),
                            audio: document.getElementById("audioRemote"),
                          },
                        },
                        sessionDescriptionHandlerOptions: {
                          constraints: {
                            audio: true,
                            video: false,
                          },
                          rtcConfiguration: {
                            RTCConstraints: {
                              optional: [
                                {
                                  DtlsSrtpKeyAgreement: "true",
                                },
                              ],
                            },
                            stream: ctxSip.Stream,
                          },
                        },
                      });
                      s.direction = "outgoing";
                      ctxSip.newSession(s);

                      //var remoteVideo = document.getElementById("audioRemote");
                      //var localVideo = document.getElementById("audioRemote");

                      //s.on("trackAdded", function () {
                      // We need to check the peer connection to determine which track was added

                      //  var pc = s.sessionDescriptionHandler.peerConnection;

                      // Gets remote tracks
                      //  var remoteStream = new MediaStream();
                      //  pc.getReceivers().forEach(function (receiver) {
                      //     remoteStream.addTrack(receiver.track);
                      //  });
                      //  remoteVideo.srcObject = remoteStream;
                      //  remoteVideo.play();
                      //});
                    } catch (e) {
                      throw e;
                    }
                  },

                  sipTransfer: function (sessionid) {
                    // var s = ctxSip.Sessions[sessionid];
                    // var numberDisplay = document.getElementById('numDisplay');
                    // var target = window.prompt('Enter destination number', '');
                    // document.getElementById('transferButton').click();
                    // numberDisplay.value = target;
                    // ctxSip.sipSendDTMF(target);
                    // ctxSip.phoneCallButtonPressed(sessionid);
                    // ctxSip.setCallSessionStatus('<i>Transfering the call...</i>');
                  },

                  sipHangUp: function (sessionid) {
                    endCallWss(sessionid);
                    var s = ctxSip.Sessions[sessionid];
                    // //console.log("🚀 ~ file: app.js:638 ~ s", s)

                    s.terminate();
                    if (!s) {
                      return;
                    } else if (s.startTime) {
                      s.bye();
                    } else if (s.reject) {
                      s.reject();
                    } else if (s.cancel) {
                      s.cancel();
                    }
                  },

                  sipSendDTMF: function (digit) {
                    try {
                      ctxSip.dtmfTone.play();
                    } catch (e) {}

                    var a = ctxSip.callActiveID;
                    if (a) {
                      var s = ctxSip.Sessions[a];
                      s.dtmf(digit);
                    }
                  },

                  phoneCallButtonPressed: function (sessionid) {
                    // //console.log('Chấp nhận cuộc gọi');
                    var s = ctxSip.Sessions[sessionid];
                    // var target = $('#numDisplay').val();

                    if (!s) {
                      // $('#numDisplay').val('');
                      // ctxSip.sipCall(target);
                    } else if (s.accept && !s.startTime) {
                      s.accept({
                        media: {
                          remote: {
                            video: document.getElementById("audioRemote"),
                            audio: document.getElementById("audioRemote"),
                          },
                        },
                        sessionDescriptionHandlerOptions: {
                          constraints: {
                            audio: true,
                            video: false,
                          },
                          rtcConfiguration: {
                            RTCConstraints: {
                              optional: [
                                {
                                  DtlsSrtpKeyAgreement: "true",
                                },
                              ],
                            },
                            stream: ctxSip.Stream,
                          },
                        },
                      });
                      // setCountWatchInCall();
                    }
                  },

                  phoneMuteButtonPressed: function (sessionid) {
                    var s = ctxSip.Sessions[sessionid];

                    if (!s.isMuted) {
                      s.mute();
                    } else {
                      s.unmute();
                    }
                  },

                  phoneHoldButtonPressed: function (sessionid) {
                    var s = ctxSip.Sessions[sessionid];

                    if (s.isOnHold().local === true) {
                      s.unhold();
                    } else {
                      s.hold();
                    }
                  },

                  setError: function (err, title, msg, closable) {
                    // Show modal if err = true
                    // if (err === true) {
                    //     $('#mdlError p').html(msg);
                    //     $('#mdlError').modal('show');
                    //     if (closable) {
                    //         var b =
                    //             '<button type="button" class="close" data-dismiss="modal">&times;</button>';
                    //         $('#mdlError .modal-header').find('button').remove();
                    //         $('#mdlError .modal-header').prepend(b);
                    //         $('#mdlError .modal-title').html(title);
                    //         $('#mdlError').modal({
                    //             keyboard: true
                    //         });
                    //     } else {
                    //         $('#mdlError .modal-header').find('button').remove();
                    //         $('#mdlError .modal-title').html(title);
                    //         $('#mdlError').modal({
                    //             keyboard: false
                    //         });
                    //     }
                    //     $('#numDisplay').prop('disabled', 'disabled');
                    // } else {
                    //     $('#numDisplay').removeProp('disabled');
                    //     $('#mdlError').modal('hide');
                    // }
                  },

                  /**
                   * Tests for a capable browser, return bool, and shows an
                   * error modal on fail.
                   */
                  hasWebRTC: function () {
                    if (navigator.webkitGetUserMedia) {
                      return true;
                    } else if (navigator.mozGetUserMedia) {
                      return true;
                    } else if (navigator.getUserMedia) {
                      return true;
                    } else {
                      // ctxSip.setError(
                      //     true,
                      //     'Unsupported Browser.',
                      //     'Your browser does not support the features required for this phone.'
                      // );
                      //Notiflix.Notify.Failure(
                      //  "Your browser does not support the features required for this phone."
                      //);
                      window.console.error("WebRTC support not found");
                      return false;
                    }
                  },
                };

                // Throw an error if the browser can't hack it.
                if (!ctxSip.hasWebRTC()) {
                  return true;
                }

                ctxSip.phone = new SIP.UA(ctxSip.config);

                ctxSip.phone.on("connected", function (e) {
                  // ctxSip.setStatus('Connected');
                  // ctxSip.setError(false);
                });

                ctxSip.phone.on("disconnected", function (e) {
                  // ctxSip.setStatus('Disconnected');
                  // disable phone
                  // ctxSip.setError(
                  //     true,
                  //     'Websocket Disconnected.',
                  //     'An Error occurred connecting to the websocket.'
                  // );
                  //Notiflix.Notify.Failure(
                  //  "An Error occurred connecting to the websocket."
                  //);
                });

                ctxSip.phone.on("registered", function (e) {
                  // toastr.success('Kết nối tổng đài thành công!');
                  //Notiflix.Notify.success("Kết nối tổng đài thành công!");
                  // ctxSip.setStatus('Registered');

                  // ctxSip.setError(false);
                  var closeEditorWarning = function () {
                    return "If you close this window, you will not be able to make or receive calls from your browser.";
                  };

                  var closePhone = function () {
                    // stop the phone on unload
                    localStorage.removeItem("ctxPhone");
                    ctxSip.phone.stop();
                  };

                  window.onbeforeunload = closeEditorWarning;
                  window.onunload = closePhone;

                  // This key is set to prevent multiple windows.
                  localStorage.setItem("ctxPhone", "true");

                  // $('#mldError').modal('hide');
                  // ctxSip.setStatus('Available');

                  // Get the userMedia and cache the stream
                  //    if (SIP.WebRTC.isSupported()) {
                  //        SIP.WebRTC.getUserMedia({ audio : true, video : false }, ctxSip.getUserMediaSuccess, ctxSip.getUserMediaFailure);
                  //    }
                });

                ctxSip.phone.on("registrationFailed", function (e) {
                  //Notiflix.Notify.info("Đang kết nối tổng đài!");
                  reloadConnect();
                  // ctxSip.setError(
                  //     true,
                  //     'Registration Error.',
                  //     'An Error occurred registering your phone. Check your settings.'
                  // );
                  // //Notiflix.Notify.Failure(
                  //     'An Error occurred registering your phone. Check your settings.'
                  // );
                  // ctxSip.setStatus('Error: Registration Failed');
                });
                var onConnect = 1;
                reloadConnect = function () {
                  if (onConnect < 50) {
                    // onconect is 10 25  //Notiflix
                    if (onConnect == 30) {
                      //Notiflix.Notify.info("Đang cố gắng kết nối...");
                    }
                    ctxSip.phone = new SIP.UA(ctxSip.config);

                    ctxSip.phone.on("connected", function (e) {
                      // ctxSip.setStatus('Connected');
                      // ctxSip.setError(false);
                    });

                    ctxSip.phone.on("disconnected", function (e) {
                      // ctxSip.setStatus('Disconnected');
                      // disable phone
                      // ctxSip.setError(
                      //     true,
                      //     'Websocket Disconnected.',
                      //     'An Error occurred connecting to the websocket.'
                      // );
                      //Notiflix.Notify.Failure(
                      //  "An Error occurred connecting to the websocket."
                      //);
                    });

                    ctxSip.phone.on("registered", function (e) {
                      // toastr.success('Kết nối tổng đài thành công!');
                      //Notiflix.Notify.success("Kết nối tổng đài thành công!");
                      // ctxSip.setStatus('Registered');

                      // ctxSip.setError(false);
                      var closeEditorWarning = function () {
                        return "If you close this window, you will not be able to make or receive calls from your browser.";
                      };

                      var closePhone = function () {
                        // stop the phone on unload
                        localStorage.removeItem("ctxPhone");
                        ctxSip.phone.stop();
                      };

                      window.onbeforeunload = closeEditorWarning;
                      window.onunload = closePhone;

                      // This key is set to prevent multiple windows.
                      localStorage.setItem("ctxPhone", "true");
                    });

                    ctxSip.phone.on("registrationFailed", function (e) {
                      reloadConnect();

                      // ctxSip.setStatus('Error: Registration Failed');
                    });

                    ctxSip.phone.on("unregistered", function (e) {
                      // toastr.error('Lỗi kết nối tổng đài, vui lòng load lại trang!');
                      // ctxSip.setStatus('Error: Registration Failed');
                    });
                    ctxSip.phone.on(
                      "invite",

                      function (incomingSession) {
                        var s = incomingSession;

                        s.direction = "incoming";
                        ctxSip.newSession(s);
                      }
                    );
                  } else {
                    //Notiflix.Notify.failure(
                    //  "Lỗi kết nối tổng đài, vui lòng liên hệ quản trị viên!"
                    //);
                  }
                  onConnect++;
                };
                ctxSip.phone.on("unregistered", function (e) {
                  // toastr.error('Lỗi kết nối tổng đài, vui lòng load lại trang!');
                  //Notiflix.Notify.Failure(
                  //  "An Error occurred registering your phone. Please wait while we try to connect it again."
                  //);
                  // ctxSip.setStatus('Error: Registration Failed');
                });
                ctxSip.phone.on(
                  "invite",

                  function (incomingSession) {
                    var s = incomingSession;

                    s.direction = "incoming";
                    ctxSip.newSession(s);
                  }
                );

                // Hide the spalsh after 3 secs.
                setTimeout(function () {
                  ctxSip.logShow();
                }, 3000);

                /**
                 * Stopwatch object used for call timers
                 *
                 * @param {dom element} elem
                 * @param {[object]} options
                 */
                var Stopwatch = function (elem, options) {
                  // private functions
                  function createTimer() {
                    return document.createElement("span");
                  }

                  var timer = createTimer(),
                    offset,
                    clock,
                    interval;

                  // default options
                  options = options || {};
                  options.delay = options.delay || 1000;
                  options.startTime = options.startTime || Date.now();

                  // append elements
                  // elem.appendChild(timer);

                  function start() {
                    if (!interval) {
                      offset = options.startTime;
                      interval = setInterval(update, options.delay);
                    }
                  }

                  function stop() {
                    if (interval) {
                      clearInterval(interval);
                      interval = null;
                    }
                  }

                  function reset() {
                    clock = 0;
                    render();
                  }

                  function update() {
                    clock += delta();
                    render();
                  }

                  function render() {
                    //timer.innerHTML = moment.utc(clock).format("mm:ss");
                  }

                  function delta() {
                    var now = Date.now(),
                      d = now - offset;

                    offset = now;
                    return d;
                  }

                  // initialize
                  reset();

                  // public API
                  this.start = start; //function() { start; }
                  this.stop = stop; //function() { stop; }
                };
              }
            } else {
              //toastr.error("WebRTC is not supported by your browser, please contact developer.");
            }
          },
        });
      }
      // localStorage.setItem("SIPCreds", JSON.stringify(user));
    </script>
  </body>
</html>
